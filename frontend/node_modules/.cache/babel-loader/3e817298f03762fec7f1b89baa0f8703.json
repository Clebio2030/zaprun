{"ast":null,"code":"import React,{useContext,useEffect,useReducer,useRef,useState}from\"react\";import{makeStyles}from\"@material-ui/core/styles\";import toastError from\"../../errors/toastError\";import Popover from\"@material-ui/core/Popover\";import ForumIcon from\"@material-ui/icons/Forum\";import{Badge,IconButton,List,ListItem,ListItemText,Paper,Typography}from\"@material-ui/core\";import api from\"../../services/api\";import{isArray}from\"lodash\";// import { SocketContext } from \"../../context/Socket/SocketContext\";\nimport{useDate}from\"../../hooks/useDate\";import{AuthContext}from\"../../context/Auth/AuthContext\";import notifySound from\"../../assets/chat_notify.mp3\";import useSound from\"use-sound\";import{i18n}from\"../../translate/i18n\";const useStyles=makeStyles(theme=>({mainPaper:{flex:1,maxHeight:300,maxWidth:500,padding:theme.spacing(1),overflowY:\"scroll\",...theme.scrollbarStyles}}));const reducer=(state,action)=>{if(action.type===\"LOAD_CHATS\"){const chats=action.payload;const newChats=[];if(isArray(chats)){chats.forEach(chat=>{const chatIndex=state.findIndex(u=>u.id===chat.id);if(chatIndex!==-1){state[chatIndex]=chat;}else{newChats.push(chat);}});}return[...state,...newChats];}if(action.type===\"UPDATE_CHATS\"){const chat=action.payload;const chatIndex=state.findIndex(u=>u.id===chat.id);if(chatIndex!==-1){state[chatIndex]=chat;return[...state];}else{return[chat,...state];}}if(action.type===\"DELETE_CHAT\"){const chatId=action.payload;const chatIndex=state.findIndex(u=>u.id===chatId);if(chatIndex!==-1){state.splice(chatIndex,1);}return[...state];}if(action.type===\"RESET\"){return[];}if(action.type===\"CHANGE_CHAT\"){const changedChats=state.map(chat=>{if(chat.id===action.payload.chat.id){return action.payload.chat;}return chat;});return changedChats;}};export default function ChatPopover(){const classes=useStyles();//   const socketManager = useContext(SocketContext);\nconst{user,socket}=useContext(AuthContext);const[loading,setLoading]=useState(false);const[anchorEl,setAnchorEl]=useState(null);const[pageNumber,setPageNumber]=useState(1);const[hasMore,setHasMore]=useState(false);const[searchParam]=useState(\"\");const[chats,dispatch]=useReducer(reducer,[]);const[invisible,setInvisible]=useState(true);const{datetimeToClient}=useDate();const[play]=useSound(notifySound);const soundAlertRef=useRef();useEffect(()=>{soundAlertRef.current=play;if(!(\"Notification\"in window)){console.log(\"This browser doesn't support notifications\");}else{Notification.requestPermission();}},[play]);useEffect(()=>{dispatch({type:\"RESET\"});setPageNumber(1);},[searchParam]);useEffect(()=>{setLoading(true);const delayDebounceFn=setTimeout(()=>{fetchChats();},500);return()=>clearTimeout(delayDebounceFn);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[searchParam,pageNumber]);useEffect(()=>{if(user.companyId){const companyId=user.companyId;//    const socket = socketManager.GetSocket();\nconst onCompanyChatPopover=data=>{if(data.action===\"new-message\"){dispatch({type:\"CHANGE_CHAT\",payload:data});if(data.newMessage.senderId!==user.id){soundAlertRef.current();}}if(data.action===\"update\"){dispatch({type:\"CHANGE_CHAT\",payload:data});}};socket.on(\"company-\".concat(companyId,\"-chat\"),onCompanyChatPopover);return()=>{socket.off(\"company-\".concat(companyId,\"-chat\"),onCompanyChatPopover);};}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[user]);useEffect(()=>{let unreadsCount=0;if(chats.length>0){for(let chat of chats){for(let chatUser of chat.users){if(chatUser.userId===user.id){unreadsCount+=chatUser.unreads;}}}}if(unreadsCount>0){setInvisible(false);}else{setInvisible(true);}},[chats,user.id]);const fetchChats=async()=>{try{const{data}=await api.get(\"/chats/\",{params:{searchParam,pageNumber}});dispatch({type:\"LOAD_CHATS\",payload:data.records});setHasMore(data.hasMore);setLoading(false);}catch(err){toastError(err);}};const loadMore=()=>{setPageNumber(prevState=>prevState+1);};const handleScroll=e=>{if(!hasMore||loading)return;const{scrollTop,scrollHeight,clientHeight}=e.currentTarget;if(scrollHeight-(scrollTop+100)<clientHeight){loadMore();}};const handleClick=event=>{setAnchorEl(event.currentTarget);setInvisible(true);};const handleClose=()=>{setAnchorEl(null);};const goToMessages=chat=>{window.location.href=\"/chats/\".concat(chat.uuid);};const open=Boolean(anchorEl);const id=open?\"simple-popover\":undefined;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(IconButton,{\"aria-describedby\":id,variant:\"contained\",color:invisible?\"default\":\"inherit\",onClick:handleClick,style:{color:\"white\"}},/*#__PURE__*/React.createElement(Badge,{color:\"secondary\",variant:\"dot\",invisible:invisible},/*#__PURE__*/React.createElement(ForumIcon,null))),/*#__PURE__*/React.createElement(Popover,{id:id,open:open,anchorEl:anchorEl,onClose:handleClose,anchorOrigin:{vertical:\"bottom\",horizontal:\"center\"},transformOrigin:{vertical:\"top\",horizontal:\"center\"}},/*#__PURE__*/React.createElement(Paper,{variant:\"outlined\",onScroll:handleScroll,className:classes.mainPaper},/*#__PURE__*/React.createElement(List,{component:\"nav\",\"aria-label\":\"main mailbox folders\",style:{minWidth:300}},isArray(chats)&&chats.map((item,key)=>/*#__PURE__*/React.createElement(ListItem,{key:key,style:{background:key%2===0?\"#ededed\":\"white\",border:\"1px solid #eee\",cursor:\"pointer\"},onClick:()=>goToMessages(item),button:true},/*#__PURE__*/React.createElement(ListItemText,{primary:item.lastMessage,secondary:/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Typography,{component:\"span\",style:{fontSize:12}},datetimeToClient(item.updatedAt)),/*#__PURE__*/React.createElement(\"span\",{style:{marginTop:5,display:\"block\"}}))}))),isArray(chats)&&chats.length===0&&/*#__PURE__*/React.createElement(ListItemText,{primary:i18n.t(\"mainDrawer.appBar.notRegister\")})))));}","map":{"version":3,"names":["React","useContext","useEffect","useReducer","useRef","useState","makeStyles","toastError","Popover","ForumIcon","Badge","IconButton","List","ListItem","ListItemText","Paper","Typography","api","isArray","useDate","AuthContext","notifySound","useSound","i18n","useStyles","theme","mainPaper","flex","maxHeight","maxWidth","padding","spacing","overflowY","scrollbarStyles","reducer","state","action","type","chats","payload","newChats","forEach","chat","chatIndex","findIndex","u","id","push","chatId","splice","changedChats","map","ChatPopover","classes","user","socket","loading","setLoading","anchorEl","setAnchorEl","pageNumber","setPageNumber","hasMore","setHasMore","searchParam","dispatch","invisible","setInvisible","datetimeToClient","play","soundAlertRef","current","window","console","log","Notification","requestPermission","delayDebounceFn","setTimeout","fetchChats","clearTimeout","companyId","onCompanyChatPopover","data","newMessage","senderId","on","concat","off","unreadsCount","length","chatUser","users","userId","unreads","get","params","records","err","loadMore","prevState","handleScroll","e","scrollTop","scrollHeight","clientHeight","currentTarget","handleClick","event","handleClose","goToMessages","location","href","uuid","open","Boolean","undefined","createElement","variant","color","onClick","style","onClose","anchorOrigin","vertical","horizontal","transformOrigin","onScroll","className","component","minWidth","item","key","background","border","cursor","button","primary","lastMessage","secondary","Fragment","fontSize","updatedAt","marginTop","display","t"],"sources":["C:/ProjectsCode/ZapRun/ZapRun/frontend/src/pages/Chat/ChatPopover.js"],"sourcesContent":["import React, {\r\n  useContext,\r\n  useEffect,\r\n  useReducer,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport toastError from \"../../errors/toastError\";\r\nimport Popover from \"@material-ui/core/Popover\";\r\nimport ForumIcon from \"@material-ui/icons/Forum\";\r\nimport {\r\n  Badge,\r\n  IconButton,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Paper,\r\n  Typography,\r\n} from \"@material-ui/core\";\r\nimport api from \"../../services/api\";\r\nimport { isArray } from \"lodash\";\r\n// import { SocketContext } from \"../../context/Socket/SocketContext\";\r\nimport { useDate } from \"../../hooks/useDate\";\r\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\r\n\r\nimport notifySound from \"../../assets/chat_notify.mp3\";\r\nimport useSound from \"use-sound\";\r\nimport { i18n } from \"../../translate/i18n\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  mainPaper: {\r\n    flex: 1,\r\n    maxHeight: 300,\r\n    maxWidth: 500,\r\n    padding: theme.spacing(1),\r\n    overflowY: \"scroll\",\r\n    ...theme.scrollbarStyles,\r\n  },\r\n}));\r\n\r\nconst reducer = (state, action) => {\r\n  if (action.type === \"LOAD_CHATS\") {\r\n    const chats = action.payload;\r\n    const newChats = [];\r\n\r\n    if (isArray(chats)) {\r\n      chats.forEach((chat) => {\r\n        const chatIndex = state.findIndex((u) => u.id === chat.id);\r\n        if (chatIndex !== -1) {\r\n          state[chatIndex] = chat;\r\n        } else {\r\n          newChats.push(chat);\r\n        }\r\n      });\r\n    }\r\n\r\n    return [...state, ...newChats];\r\n  }\r\n\r\n  if (action.type === \"UPDATE_CHATS\") {\r\n    const chat = action.payload;\r\n    const chatIndex = state.findIndex((u) => u.id === chat.id);\r\n\r\n    if (chatIndex !== -1) {\r\n      state[chatIndex] = chat;\r\n      return [...state];\r\n    } else {\r\n      return [chat, ...state];\r\n    }\r\n  }\r\n\r\n  if (action.type === \"DELETE_CHAT\") {\r\n    const chatId = action.payload;\r\n\r\n    const chatIndex = state.findIndex((u) => u.id === chatId);\r\n    if (chatIndex !== -1) {\r\n      state.splice(chatIndex, 1);\r\n    }\r\n    return [...state];\r\n  }\r\n\r\n  if (action.type === \"RESET\") {\r\n    return [];\r\n  }\r\n\r\n  if (action.type === \"CHANGE_CHAT\") {\r\n    const changedChats = state.map((chat) => {\r\n      if (chat.id === action.payload.chat.id) {\r\n        return action.payload.chat;\r\n      }\r\n      return chat;\r\n    });\r\n    return changedChats;\r\n  }\r\n};\r\n\r\nexport default function ChatPopover() {\r\n  const classes = useStyles();\r\n\r\n//   const socketManager = useContext(SocketContext);\r\n  const { user, socket } = useContext(AuthContext);\r\n\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n  const [pageNumber, setPageNumber] = useState(1);\r\n  const [hasMore, setHasMore] = useState(false);\r\n  const [searchParam] = useState(\"\");\r\n  const [chats, dispatch] = useReducer(reducer, []);\r\n  const [invisible, setInvisible] = useState(true);\r\n  const { datetimeToClient } = useDate();\r\n  const [play] = useSound(notifySound);\r\n  const soundAlertRef = useRef();\r\n\r\n  useEffect(() => {\r\n    soundAlertRef.current = play;\r\n\r\n    if (!(\"Notification\" in window)) {\r\n      console.log(\"This browser doesn't support notifications\");\r\n    } else {\r\n      Notification.requestPermission();\r\n    }\r\n  }, [play]);\r\n\r\n  useEffect(() => {\r\n    dispatch({ type: \"RESET\" });\r\n    setPageNumber(1);\r\n  }, [searchParam]);\r\n\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    const delayDebounceFn = setTimeout(() => {\r\n      fetchChats();\r\n    }, 500);\r\n    return () => clearTimeout(delayDebounceFn);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [searchParam, pageNumber]);\r\n\r\n  useEffect(() => {\r\n    if (user.companyId) {\r\n\r\n      const companyId = user.companyId;\r\n//    const socket = socketManager.GetSocket();\r\n\r\n      const onCompanyChatPopover = (data) => {\r\n        if (data.action === \"new-message\") {\r\n          dispatch({ type: \"CHANGE_CHAT\", payload: data });\r\n          if (data.newMessage.senderId !== user.id) {\r\n\r\n            soundAlertRef.current();\r\n          }\r\n        }\r\n        if (data.action === \"update\") {\r\n          dispatch({ type: \"CHANGE_CHAT\", payload: data });\r\n        }\r\n      }\r\n\r\n      socket.on(`company-${companyId}-chat`, onCompanyChatPopover);\r\n\r\n      return () => {\r\n        socket.off(`company-${companyId}-chat`, onCompanyChatPopover);\r\n      };\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [user]);\r\n\r\n\r\n  useEffect(() => {\r\n    let unreadsCount = 0;\r\n    if (chats.length > 0) {\r\n      for (let chat of chats) {\r\n        for (let chatUser of chat.users) {\r\n          if (chatUser.userId === user.id) {\r\n            unreadsCount += chatUser.unreads;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (unreadsCount > 0) {\r\n      setInvisible(false);\r\n    } else {\r\n      setInvisible(true);\r\n    }\r\n  }, [chats, user.id]);\r\n\r\n  const fetchChats = async () => {\r\n    try {\r\n      const { data } = await api.get(\"/chats/\", {\r\n        params: { searchParam, pageNumber },\r\n      });\r\n      dispatch({ type: \"LOAD_CHATS\", payload: data.records });\r\n      setHasMore(data.hasMore);\r\n      setLoading(false);\r\n    } catch (err) {\r\n      toastError(err);\r\n    }\r\n  };\r\n\r\n  const loadMore = () => {\r\n    setPageNumber((prevState) => prevState + 1);\r\n  };\r\n\r\n  const handleScroll = (e) => {\r\n    if (!hasMore || loading) return;\r\n    const { scrollTop, scrollHeight, clientHeight } = e.currentTarget;\r\n    if (scrollHeight - (scrollTop + 100) < clientHeight) {\r\n      loadMore();\r\n    }\r\n  };\r\n\r\n  const handleClick = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n    setInvisible(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const goToMessages = (chat) => {\r\n    window.location.href = `/chats/${chat.uuid}`;\r\n  };\r\n\r\n  const open = Boolean(anchorEl);\r\n  const id = open ? \"simple-popover\" : undefined;\r\n\r\n  return (\r\n    <div>\r\n      <IconButton\r\n        aria-describedby={id}\r\n        variant=\"contained\"\r\n        color={invisible ? \"default\" : \"inherit\"}\r\n        onClick={handleClick}\r\n        style={{ color: \"white\" }}\r\n      >\r\n        <Badge color=\"secondary\" variant=\"dot\" invisible={invisible}>\r\n          <ForumIcon />\r\n        </Badge>\r\n      </IconButton>\r\n      <Popover\r\n        id={id}\r\n        open={open}\r\n        anchorEl={anchorEl}\r\n        onClose={handleClose}\r\n        anchorOrigin={{\r\n          vertical: \"bottom\",\r\n          horizontal: \"center\",\r\n        }}\r\n        transformOrigin={{\r\n          vertical: \"top\",\r\n          horizontal: \"center\",\r\n        }}\r\n      >\r\n        <Paper\r\n          variant=\"outlined\"\r\n          onScroll={handleScroll}\r\n          className={classes.mainPaper}\r\n        >\r\n          <List\r\n            component=\"nav\"\r\n            aria-label=\"main mailbox folders\"\r\n            style={{ minWidth: 300 }}\r\n          >\r\n            {isArray(chats) &&\r\n              chats.map((item, key) => (\r\n                <ListItem\r\n                  key={key}\r\n                  style={{\r\n                    background: key % 2 === 0 ? \"#ededed\" : \"white\",\r\n                    border: \"1px solid #eee\",\r\n                    cursor: \"pointer\",\r\n                  }}\r\n                  onClick={() => goToMessages(item)}\r\n                  button\r\n                >\r\n                  <ListItemText\r\n                    primary={item.lastMessage}\r\n                    secondary={\r\n                      <>\r\n                        <Typography component=\"span\" style={{ fontSize: 12 }}>\r\n                          {datetimeToClient(item.updatedAt)}\r\n                        </Typography>\r\n                        <span style={{ marginTop: 5, display: \"block\" }}></span>\r\n                      </>\r\n                    }\r\n                  />\r\n                </ListItem>\r\n              ))}\r\n            {isArray(chats) && chats.length === 0 && (\r\n              <ListItemText primary={i18n.t(\"mainDrawer.appBar.notRegister\")} />\r\n            )}\r\n          </List>\r\n        </Paper>\r\n      </Popover>\r\n    </div>\r\n  );\r\n}"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EACVC,UAAU,CACVC,SAAS,CACTC,UAAU,CACVC,MAAM,CACNC,QAAQ,KACH,OAAO,CACd,OAASC,UAAU,KAAQ,0BAA0B,CACrD,MAAO,CAAAC,UAAU,KAAM,yBAAyB,CAChD,MAAO,CAAAC,OAAO,KAAM,2BAA2B,CAC/C,MAAO,CAAAC,SAAS,KAAM,0BAA0B,CAChD,OACEC,KAAK,CACLC,UAAU,CACVC,IAAI,CACJC,QAAQ,CACRC,YAAY,CACZC,KAAK,CACLC,UAAU,KACL,mBAAmB,CAC1B,MAAO,CAAAC,GAAG,KAAM,oBAAoB,CACpC,OAASC,OAAO,KAAQ,QAAQ,CAChC;AACA,OAASC,OAAO,KAAQ,qBAAqB,CAC7C,OAASC,WAAW,KAAQ,gCAAgC,CAE5D,MAAO,CAAAC,WAAW,KAAM,8BAA8B,CACtD,MAAO,CAAAC,QAAQ,KAAM,WAAW,CAChC,OAASC,IAAI,KAAQ,sBAAsB,CAE3C,KAAM,CAAAC,SAAS,CAAGlB,UAAU,CAAEmB,KAAK,GAAM,CACvCC,SAAS,CAAE,CACTC,IAAI,CAAE,CAAC,CACPC,SAAS,CAAE,GAAG,CACdC,QAAQ,CAAE,GAAG,CACbC,OAAO,CAAEL,KAAK,CAACM,OAAO,CAAC,CAAC,CAAC,CACzBC,SAAS,CAAE,QAAQ,CACnB,GAAGP,KAAK,CAACQ,eACX,CACF,CAAC,CAAC,CAAC,CAEH,KAAM,CAAAC,OAAO,CAAGA,CAACC,KAAK,CAAEC,MAAM,GAAK,CACjC,GAAIA,MAAM,CAACC,IAAI,GAAK,YAAY,CAAE,CAChC,KAAM,CAAAC,KAAK,CAAGF,MAAM,CAACG,OAAO,CAC5B,KAAM,CAAAC,QAAQ,CAAG,EAAE,CAEnB,GAAItB,OAAO,CAACoB,KAAK,CAAC,CAAE,CAClBA,KAAK,CAACG,OAAO,CAAEC,IAAI,EAAK,CACtB,KAAM,CAAAC,SAAS,CAAGR,KAAK,CAACS,SAAS,CAAEC,CAAC,EAAKA,CAAC,CAACC,EAAE,GAAKJ,IAAI,CAACI,EAAE,CAAC,CAC1D,GAAIH,SAAS,GAAK,CAAC,CAAC,CAAE,CACpBR,KAAK,CAACQ,SAAS,CAAC,CAAGD,IAAI,CACzB,CAAC,IAAM,CACLF,QAAQ,CAACO,IAAI,CAACL,IAAI,CAAC,CACrB,CACF,CAAC,CAAC,CACJ,CAEA,MAAO,CAAC,GAAGP,KAAK,CAAE,GAAGK,QAAQ,CAAC,CAChC,CAEA,GAAIJ,MAAM,CAACC,IAAI,GAAK,cAAc,CAAE,CAClC,KAAM,CAAAK,IAAI,CAAGN,MAAM,CAACG,OAAO,CAC3B,KAAM,CAAAI,SAAS,CAAGR,KAAK,CAACS,SAAS,CAAEC,CAAC,EAAKA,CAAC,CAACC,EAAE,GAAKJ,IAAI,CAACI,EAAE,CAAC,CAE1D,GAAIH,SAAS,GAAK,CAAC,CAAC,CAAE,CACpBR,KAAK,CAACQ,SAAS,CAAC,CAAGD,IAAI,CACvB,MAAO,CAAC,GAAGP,KAAK,CAAC,CACnB,CAAC,IAAM,CACL,MAAO,CAACO,IAAI,CAAE,GAAGP,KAAK,CAAC,CACzB,CACF,CAEA,GAAIC,MAAM,CAACC,IAAI,GAAK,aAAa,CAAE,CACjC,KAAM,CAAAW,MAAM,CAAGZ,MAAM,CAACG,OAAO,CAE7B,KAAM,CAAAI,SAAS,CAAGR,KAAK,CAACS,SAAS,CAAEC,CAAC,EAAKA,CAAC,CAACC,EAAE,GAAKE,MAAM,CAAC,CACzD,GAAIL,SAAS,GAAK,CAAC,CAAC,CAAE,CACpBR,KAAK,CAACc,MAAM,CAACN,SAAS,CAAE,CAAC,CAAC,CAC5B,CACA,MAAO,CAAC,GAAGR,KAAK,CAAC,CACnB,CAEA,GAAIC,MAAM,CAACC,IAAI,GAAK,OAAO,CAAE,CAC3B,MAAO,EAAE,CACX,CAEA,GAAID,MAAM,CAACC,IAAI,GAAK,aAAa,CAAE,CACjC,KAAM,CAAAa,YAAY,CAAGf,KAAK,CAACgB,GAAG,CAAET,IAAI,EAAK,CACvC,GAAIA,IAAI,CAACI,EAAE,GAAKV,MAAM,CAACG,OAAO,CAACG,IAAI,CAACI,EAAE,CAAE,CACtC,MAAO,CAAAV,MAAM,CAACG,OAAO,CAACG,IAAI,CAC5B,CACA,MAAO,CAAAA,IAAI,CACb,CAAC,CAAC,CACF,MAAO,CAAAQ,YAAY,CACrB,CACF,CAAC,CAED,cAAe,SAAS,CAAAE,WAAWA,CAAA,CAAG,CACpC,KAAM,CAAAC,OAAO,CAAG7B,SAAS,CAAC,CAAC,CAE7B;AACE,KAAM,CAAE8B,IAAI,CAAEC,MAAO,CAAC,CAAGtD,UAAU,CAACmB,WAAW,CAAC,CAGhD,KAAM,CAACoC,OAAO,CAAEC,UAAU,CAAC,CAAGpD,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACqD,QAAQ,CAAEC,WAAW,CAAC,CAAGtD,QAAQ,CAAC,IAAI,CAAC,CAC9C,KAAM,CAACuD,UAAU,CAAEC,aAAa,CAAC,CAAGxD,QAAQ,CAAC,CAAC,CAAC,CAC/C,KAAM,CAACyD,OAAO,CAAEC,UAAU,CAAC,CAAG1D,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAC2D,WAAW,CAAC,CAAG3D,QAAQ,CAAC,EAAE,CAAC,CAClC,KAAM,CAACiC,KAAK,CAAE2B,QAAQ,CAAC,CAAG9D,UAAU,CAAC+B,OAAO,CAAE,EAAE,CAAC,CACjD,KAAM,CAACgC,SAAS,CAAEC,YAAY,CAAC,CAAG9D,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAAE+D,gBAAiB,CAAC,CAAGjD,OAAO,CAAC,CAAC,CACtC,KAAM,CAACkD,IAAI,CAAC,CAAG/C,QAAQ,CAACD,WAAW,CAAC,CACpC,KAAM,CAAAiD,aAAa,CAAGlE,MAAM,CAAC,CAAC,CAE9BF,SAAS,CAAC,IAAM,CACdoE,aAAa,CAACC,OAAO,CAAGF,IAAI,CAE5B,GAAI,EAAE,cAAc,EAAI,CAAAG,MAAM,CAAC,CAAE,CAC/BC,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC,CAC3D,CAAC,IAAM,CACLC,YAAY,CAACC,iBAAiB,CAAC,CAAC,CAClC,CACF,CAAC,CAAE,CAACP,IAAI,CAAC,CAAC,CAEVnE,SAAS,CAAC,IAAM,CACd+D,QAAQ,CAAC,CAAE5B,IAAI,CAAE,OAAQ,CAAC,CAAC,CAC3BwB,aAAa,CAAC,CAAC,CAAC,CAClB,CAAC,CAAE,CAACG,WAAW,CAAC,CAAC,CAEjB9D,SAAS,CAAC,IAAM,CACduD,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAAAoB,eAAe,CAAGC,UAAU,CAAC,IAAM,CACvCC,UAAU,CAAC,CAAC,CACd,CAAC,CAAE,GAAG,CAAC,CACP,MAAO,IAAMC,YAAY,CAACH,eAAe,CAAC,CAC1C;AACF,CAAC,CAAE,CAACb,WAAW,CAAEJ,UAAU,CAAC,CAAC,CAE7B1D,SAAS,CAAC,IAAM,CACd,GAAIoD,IAAI,CAAC2B,SAAS,CAAE,CAElB,KAAM,CAAAA,SAAS,CAAG3B,IAAI,CAAC2B,SAAS,CACtC;AAEM,KAAM,CAAAC,oBAAoB,CAAIC,IAAI,EAAK,CACrC,GAAIA,IAAI,CAAC/C,MAAM,GAAK,aAAa,CAAE,CACjC6B,QAAQ,CAAC,CAAE5B,IAAI,CAAE,aAAa,CAAEE,OAAO,CAAE4C,IAAK,CAAC,CAAC,CAChD,GAAIA,IAAI,CAACC,UAAU,CAACC,QAAQ,GAAK/B,IAAI,CAACR,EAAE,CAAE,CAExCwB,aAAa,CAACC,OAAO,CAAC,CAAC,CACzB,CACF,CACA,GAAIY,IAAI,CAAC/C,MAAM,GAAK,QAAQ,CAAE,CAC5B6B,QAAQ,CAAC,CAAE5B,IAAI,CAAE,aAAa,CAAEE,OAAO,CAAE4C,IAAK,CAAC,CAAC,CAClD,CACF,CAAC,CAED5B,MAAM,CAAC+B,EAAE,YAAAC,MAAA,CAAYN,SAAS,UAASC,oBAAoB,CAAC,CAE5D,MAAO,IAAM,CACX3B,MAAM,CAACiC,GAAG,YAAAD,MAAA,CAAYN,SAAS,UAASC,oBAAoB,CAAC,CAC/D,CAAC,CACH,CACA;AACF,CAAC,CAAE,CAAC5B,IAAI,CAAC,CAAC,CAGVpD,SAAS,CAAC,IAAM,CACd,GAAI,CAAAuF,YAAY,CAAG,CAAC,CACpB,GAAInD,KAAK,CAACoD,MAAM,CAAG,CAAC,CAAE,CACpB,IAAK,GAAI,CAAAhD,IAAI,GAAI,CAAAJ,KAAK,CAAE,CACtB,IAAK,GAAI,CAAAqD,QAAQ,GAAI,CAAAjD,IAAI,CAACkD,KAAK,CAAE,CAC/B,GAAID,QAAQ,CAACE,MAAM,GAAKvC,IAAI,CAACR,EAAE,CAAE,CAC/B2C,YAAY,EAAIE,QAAQ,CAACG,OAAO,CAClC,CACF,CACF,CACF,CACA,GAAIL,YAAY,CAAG,CAAC,CAAE,CACpBtB,YAAY,CAAC,KAAK,CAAC,CACrB,CAAC,IAAM,CACLA,YAAY,CAAC,IAAI,CAAC,CACpB,CACF,CAAC,CAAE,CAAC7B,KAAK,CAAEgB,IAAI,CAACR,EAAE,CAAC,CAAC,CAEpB,KAAM,CAAAiC,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CACF,KAAM,CAAEI,IAAK,CAAC,CAAG,KAAM,CAAAlE,GAAG,CAAC8E,GAAG,CAAC,SAAS,CAAE,CACxCC,MAAM,CAAE,CAAEhC,WAAW,CAAEJ,UAAW,CACpC,CAAC,CAAC,CACFK,QAAQ,CAAC,CAAE5B,IAAI,CAAE,YAAY,CAAEE,OAAO,CAAE4C,IAAI,CAACc,OAAQ,CAAC,CAAC,CACvDlC,UAAU,CAACoB,IAAI,CAACrB,OAAO,CAAC,CACxBL,UAAU,CAAC,KAAK,CAAC,CACnB,CAAE,MAAOyC,GAAG,CAAE,CACZ3F,UAAU,CAAC2F,GAAG,CAAC,CACjB,CACF,CAAC,CAED,KAAM,CAAAC,QAAQ,CAAGA,CAAA,GAAM,CACrBtC,aAAa,CAAEuC,SAAS,EAAKA,SAAS,CAAG,CAAC,CAAC,CAC7C,CAAC,CAED,KAAM,CAAAC,YAAY,CAAIC,CAAC,EAAK,CAC1B,GAAI,CAACxC,OAAO,EAAIN,OAAO,CAAE,OACzB,KAAM,CAAE+C,SAAS,CAAEC,YAAY,CAAEC,YAAa,CAAC,CAAGH,CAAC,CAACI,aAAa,CACjE,GAAIF,YAAY,EAAID,SAAS,CAAG,GAAG,CAAC,CAAGE,YAAY,CAAE,CACnDN,QAAQ,CAAC,CAAC,CACZ,CACF,CAAC,CAED,KAAM,CAAAQ,WAAW,CAAIC,KAAK,EAAK,CAC7BjD,WAAW,CAACiD,KAAK,CAACF,aAAa,CAAC,CAChCvC,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,CAED,KAAM,CAAA0C,WAAW,CAAGA,CAAA,GAAM,CACxBlD,WAAW,CAAC,IAAI,CAAC,CACnB,CAAC,CAED,KAAM,CAAAmD,YAAY,CAAIpE,IAAI,EAAK,CAC7B8B,MAAM,CAACuC,QAAQ,CAACC,IAAI,WAAAzB,MAAA,CAAa7C,IAAI,CAACuE,IAAI,CAAE,CAC9C,CAAC,CAED,KAAM,CAAAC,IAAI,CAAGC,OAAO,CAACzD,QAAQ,CAAC,CAC9B,KAAM,CAAAZ,EAAE,CAAGoE,IAAI,CAAG,gBAAgB,CAAGE,SAAS,CAE9C,mBACEpH,KAAA,CAAAqH,aAAA,yBACErH,KAAA,CAAAqH,aAAA,CAAC1G,UAAU,EACT,mBAAkBmC,EAAG,CACrBwE,OAAO,CAAC,WAAW,CACnBC,KAAK,CAAErD,SAAS,CAAG,SAAS,CAAG,SAAU,CACzCsD,OAAO,CAAEb,WAAY,CACrBc,KAAK,CAAE,CAAEF,KAAK,CAAE,OAAQ,CAAE,eAE1BvH,KAAA,CAAAqH,aAAA,CAAC3G,KAAK,EAAC6G,KAAK,CAAC,WAAW,CAACD,OAAO,CAAC,KAAK,CAACpD,SAAS,CAAEA,SAAU,eAC1DlE,KAAA,CAAAqH,aAAA,CAAC5G,SAAS,KAAE,CACP,CACG,CAAC,cACbT,KAAA,CAAAqH,aAAA,CAAC7G,OAAO,EACNsC,EAAE,CAAEA,EAAG,CACPoE,IAAI,CAAEA,IAAK,CACXxD,QAAQ,CAAEA,QAAS,CACnBgE,OAAO,CAAEb,WAAY,CACrBc,YAAY,CAAE,CACZC,QAAQ,CAAE,QAAQ,CAClBC,UAAU,CAAE,QACd,CAAE,CACFC,eAAe,CAAE,CACfF,QAAQ,CAAE,KAAK,CACfC,UAAU,CAAE,QACd,CAAE,eAEF7H,KAAA,CAAAqH,aAAA,CAACtG,KAAK,EACJuG,OAAO,CAAC,UAAU,CAClBS,QAAQ,CAAE1B,YAAa,CACvB2B,SAAS,CAAE3E,OAAO,CAAC3B,SAAU,eAE7B1B,KAAA,CAAAqH,aAAA,CAACzG,IAAI,EACHqH,SAAS,CAAC,KAAK,CACf,aAAW,sBAAsB,CACjCR,KAAK,CAAE,CAAES,QAAQ,CAAE,GAAI,CAAE,EAExBhH,OAAO,CAACoB,KAAK,CAAC,EACbA,KAAK,CAACa,GAAG,CAAC,CAACgF,IAAI,CAAEC,GAAG,gBAClBpI,KAAA,CAAAqH,aAAA,CAACxG,QAAQ,EACPuH,GAAG,CAAEA,GAAI,CACTX,KAAK,CAAE,CACLY,UAAU,CAAED,GAAG,CAAG,CAAC,GAAK,CAAC,CAAG,SAAS,CAAG,OAAO,CAC/CE,MAAM,CAAE,gBAAgB,CACxBC,MAAM,CAAE,SACV,CAAE,CACFf,OAAO,CAAEA,CAAA,GAAMV,YAAY,CAACqB,IAAI,CAAE,CAClCK,MAAM,oBAENxI,KAAA,CAAAqH,aAAA,CAACvG,YAAY,EACX2H,OAAO,CAAEN,IAAI,CAACO,WAAY,CAC1BC,SAAS,cACP3I,KAAA,CAAAqH,aAAA,CAAArH,KAAA,CAAA4I,QAAA,mBACE5I,KAAA,CAAAqH,aAAA,CAACrG,UAAU,EAACiH,SAAS,CAAC,MAAM,CAACR,KAAK,CAAE,CAAEoB,QAAQ,CAAE,EAAG,CAAE,EAClDzE,gBAAgB,CAAC+D,IAAI,CAACW,SAAS,CACtB,CAAC,cACb9I,KAAA,CAAAqH,aAAA,SAAMI,KAAK,CAAE,CAAEsB,SAAS,CAAE,CAAC,CAAEC,OAAO,CAAE,OAAQ,CAAE,CAAO,CACvD,CACH,CACF,CACO,CACX,CAAC,CACH9H,OAAO,CAACoB,KAAK,CAAC,EAAIA,KAAK,CAACoD,MAAM,GAAK,CAAC,eACnC1F,KAAA,CAAAqH,aAAA,CAACvG,YAAY,EAAC2H,OAAO,CAAElH,IAAI,CAAC0H,CAAC,CAAC,+BAA+B,CAAE,CAAE,CAE/D,CACD,CACA,CACN,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module"}