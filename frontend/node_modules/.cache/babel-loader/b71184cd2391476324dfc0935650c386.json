{"ast":null,"code":"import React,{useContext,useState,useEffect,useReducer,useRef,memo,useCallback}from\"react\";import{isSameDay,parseISO,format}from\"date-fns\";import clsx from\"clsx\";import{isNil}from\"lodash\";import{blue,green,red}from\"@material-ui/core/colors\";import{Button,CircularProgress,Divider,IconButton,makeStyles,Badge}from\"@material-ui/core\";import{AccessTime,Block,Done,DoneAll,ExpandMore,GetApp,Facebook,Instagram,Reply,Close}from\"@material-ui/icons\";import MarkdownWrapper from\"../MarkdownWrapper\";import VcardPreview from\"../VcardPreview\";import LocationPreview from\"../LocationPreview\";import ModalImageCors from\"../ModalImageCors\";import MessageOptionsMenu from\"../MessageOptionsMenu\";import whatsBackground from\"../../assets/wa-background.png\";import whatsBackgroundDark from\"../../assets/wa-background-dark.png\";import YouTubePreview from\"../ModalYoutubeCors\";import{ReplyMessageContext}from\"../../context/ReplyingMessage/ReplyingMessageContext\";import{ForwardMessageContext}from\"../../context/ForwarMessage/ForwardMessageContext\";import api from\"../../services/api\";import toastError from\"../../errors/toastError\";// import { SocketContext } from \"../../context/Socket/SocketContext\";\nimport{i18n}from\"../../translate/i18n\";import SelectMessageCheckbox from\"./SelectMessageCheckbox\";import useCompanySettings from\"../../hooks/useSettings/companySettings\";import{AuthContext}from\"../../context/Auth/AuthContext\";import{QueueSelectedContext}from\"../../context/QueuesSelected/QueuesSelectedContext\";import AudioModal from\"../AudioModal\";import{messages}from\"../../translate/languages\";import{useParams,useHistory}from'react-router-dom';const useStyles=makeStyles(theme=>({messagesListWrapper:{overflow:\"hidden\",position:\"relative\",display:\"flex\",flexDirection:\"column\",flexGrow:1,width:\"100%\",minWidth:300,minHeight:200},currentTick:{alignItems:\"center\",textAlign:\"center\",alignSelf:\"center\",width:\"95%\",backgroundColor:theme.palette.primary.main,margin:\"10px\",borderRadius:\"10px\",boxShadow:\"1px 5px 10px #b3b3b3\"},currentTicktText:{color:theme.palette.primary,fontWeight:'bold',padding:8,alignSelf:\"center\",marginLeft:\"0px\"},messagesList:{backgroundImage:theme.mode==='light'?\"url(\".concat(whatsBackground,\")\"):\"url(\".concat(whatsBackgroundDark,\")\"),backgroundColor:theme.mode==='light'?\"transparent\":\"#0b0b0d\",display:\"flex\",flexDirection:\"column\",flexGrow:1,padding:\"20px 20px 30px 20px\",overflowY:\"scroll\",...theme.scrollbarStyles},dragElement:{background:'rgba(255, 255, 255, 0.8)',position:\"absolute\",width:\"100%\",height:\"100%\",zIndex:999999,textAlign:\"center\",fontSize:\"3em\",border:\"5px dashed #333\",color:'#333',display:\"flex\",justifyContent:\"center\",alignItems:\"center\"},circleLoading:{color:blue[500],position:\"absolute\",opacity:\"70%\",top:0,left:\"50%\",marginTop:12},messageLeft:{marginRight:20,marginTop:2,minWidth:100,maxWidth:600,height:\"auto\",display:\"block\",position:\"relative\",\"&:hover #messageActionsButton\":{display:\"flex\",position:\"absolute\",top:0,right:0},whiteSpace:\"pre-wrap\",backgroundColor:theme.mode==='light'?\"#ffffff\":\"#202c33\",color:theme.mode==='light'?\"#303030\":\"#ffffff\",alignSelf:\"flex-start\",borderTopLeftRadius:0,borderTopRightRadius:8,borderBottomLeftRadius:8,borderBottomRightRadius:8,paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:0,boxShadow:theme.mode==='light'?\"0 1px 1px #b3b3b3\":\"0 1px 1px #000000\"},quotedContainerLeft:{margin:\"-3px -80px 6px -6px\",overflow:\"hidden\",backgroundColor:theme.mode==='light'?\"#f0f0f0\":\"#1d282f\",borderRadius:\"7.5px\",display:\"flex\",position:\"relative\"},quotedMsg:{padding:10,maxWidth:300,height:\"auto\",display:\"block\",whiteSpace:\"pre-wrap\",overflow:\"hidden\"},quotedSideColorLeft:{flex:\"none\",width:\"4px\",backgroundColor:\"#388aff\"},messageRight:{marginLeft:20,marginTop:2,minWidth:100,maxWidth:600,height:\"auto\",display:\"block\",position:\"relative\",\"&:hover #messageActionsButton\":{display:\"flex\",position:\"absolute\",top:0,right:0},whiteSpace:\"pre-wrap\",backgroundColor:theme.mode==='light'?\"#dcf8c6\":\"#005c4b\",color:theme.mode==='light'?\"#303030\":\"#ffffff\",alignSelf:\"flex-end\",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottomLeftRadius:8,borderBottomRightRadius:0,paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:0,boxShadow:theme.mode==='light'?\"0 1px 1px #b3b3b3\":\"0 1px 1px #000000\"},messageRightPrivate:{marginLeft:20,marginTop:2,minWidth:100,maxWidth:600,height:\"auto\",display:\"block\",position:\"relative\",\"&:hover #messageActionsButton\":{display:\"flex\",position:\"absolute\",top:0,right:0},whiteSpace:\"pre-wrap\",backgroundColor:\"#F0E68C\",color:\"#303030\",alignSelf:\"flex-end\",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottomLeftRadius:8,borderBottomRightRadius:0,paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:0,boxShadow:theme.mode==='light'?\"0 1px 1px #b3b3b3\":\"0 1px 1px #000000\"},quotedContainerRight:{margin:\"-3px -80px 6px -6px\",overflowY:\"hidden\",backgroundColor:theme.mode==='light'?\"#cfe9ba\":\"#025144\",borderRadius:\"7.5px\",display:\"flex\",position:\"relative\"},quotedMsgRight:{padding:10,maxWidth:300,height:\"auto\",whiteSpace:\"pre-wrap\"},quotedSideColorRight:{flex:\"none\",width:\"4px\",backgroundColor:\"#35cd96\"},messageActionsButton:{display:\"none\",position:\"relative\",color:\"#999\",zIndex:1,backgroundColor:\"inherit\",opacity:\"90%\",\"&:hover, &.Mui-focusVisible\":{backgroundColor:\"inherit\"}},messageContactName:{display:\"flex\",color:\"#6bcbef\",fontWeight:500},textContentItem:{overflowWrap:\"break-word\",padding:\"3px 80px 6px 6px\"},textContentItemDeleted:{fontStyle:\"italic\",color:\"rgba(0, 0, 0, 0.36)\",overflowWrap:\"break-word\",padding:\"3px 80px 6px 6px\"},messageMedia:{objectFit:\"cover\",width:400,height:\"auto\",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottomLeftRadius:8,borderBottomRightRadius:8},timestamp:{fontSize:11,position:\"absolute\",bottom:0,right:5,color:\"#999\"},forwardMessage:{fontSize:12,fontStyle:\"italic\",position:\"absolute\",top:0,left:5,color:\"#999\",display:\"flex\",alignItems:\"center\"},dailyTimestamp:{alignItems:\"center\",textAlign:\"center\",alignSelf:\"center\",width:\"110px\",backgroundColor:\"#e1f3fb\",margin:\"10px\",borderRadius:\"10px\",boxShadow:\"0 1px 1px #b3b3b3\"},dailyTimestampText:{color:\"#808888\",padding:8,alignSelf:\"center\",marginLeft:\"0px\"},ackIcons:{fontSize:18,verticalAlign:\"middle\",marginLeft:4},deletedIcon:{fontSize:18,verticalAlign:\"middle\",marginRight:4},ackDoneAllIcon:{color:blue[500],fontSize:18,verticalAlign:\"middle\",marginLeft:4},ackPlayedIcon:{color:green[500],fontSize:18,verticalAlign:\"middle\",marginLeft:4},downloadMedia:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\",backgroundColor:\"inherit\",padding:10,color:theme.mode===\"light\"?theme.palette.light:theme.palette.dark},messageCenter:{marginTop:5,alignItems:\"center\",verticalAlign:\"center\",alignContent:\"center\",backgroundColor:\"#E1F5FEEB\",fontSize:\"12px\",minWidth:100,maxWidth:270,color:\"#272727\",borderTopLeftRadius:0,borderTopRightRadius:8,borderBottomLeftRadius:8,borderBottomRightRadius:8,paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:0,boxShadow:\"0 1px 1px #b3b3b3\"},deletedMessage:{color:'#f55d65'}}));const reducer=(state,action)=>{if(action.type===\"LOAD_MESSAGES\"){const messages=action.payload;const newMessages=[];messages.forEach(message=>{const messageIndex=state.findIndex(m=>m.id===message.id);if(messageIndex!==-1){state[messageIndex]=message;}else{newMessages.push(message);}});return[...newMessages,...state];}if(action.type===\"ADD_MESSAGE\"){const newMessage=action.payload;const messageIndex=state.findIndex(m=>m.id===newMessage.id);if(messageIndex!==-1){state[messageIndex]=newMessage;}else{state.push(newMessage);}return[...state];}if(action.type===\"UPDATE_MESSAGE\"){const messageToUpdate=action.payload;const messageIndex=state.findIndex(m=>m.id===messageToUpdate.id);if(messageIndex!==-1){state[messageIndex]=messageToUpdate;}return[...state];}if(action.type===\"RESET\"){return[];}};const MessagesList=_ref=>{let{isGroup,onDrop,whatsappId,queueId,channel}=_ref;const classes=useStyles();const[messagesList,dispatch]=useReducer(reducer,[]);const[pageNumber,setPageNumber]=useState(1);const[hasMore,setHasMore]=useState(false);const[loading,setLoading]=useState(false);const[loadingMore,setLoadingMore]=useState(false);const history=useHistory();const lastMessageRef=useRef();const[selectedMessage,setSelectedMessage]=useState({});const{setReplyingMessage}=useContext(ReplyMessageContext);const[anchorEl,setAnchorEl]=useState(null);const messageOptionsMenuOpen=Boolean(anchorEl);const{ticketId}=useParams();const currentTicketId=useRef(ticketId);const{getAll}=useCompanySettings();const[dragActive,setDragActive]=useState(false);const[lgpdDeleteMessage,setLGPDDeleteMessage]=useState(false);const{selectedQueuesMessage}=useContext(QueueSelectedContext);const{showSelectMessageCheckbox}=useContext(ForwardMessageContext);const{user,socket}=useContext(AuthContext);const companyId=user.companyId;useEffect(()=>{async function fetchData(){const settings=await getAll(companyId);let settinglgpdDeleteMessage;let settingEnableLGPD;for(const[key,value]of Object.entries(settings)){if(key===\"lgpdDeleteMessage\")settinglgpdDeleteMessage=value;if(key===\"enableLGPD\")settingEnableLGPD=value;}if(settingEnableLGPD===\"enabled\"&&settinglgpdDeleteMessage===\"enabled\"){setLGPDDeleteMessage(true);}}fetchData();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);useEffect(()=>{dispatch({type:\"RESET\"});setPageNumber(1);currentTicketId.current=ticketId;},[ticketId,selectedQueuesMessage]);useEffect(()=>{setLoading(true);const delayDebounceFn=setTimeout(()=>{const fetchMessages=async()=>{if(ticketId===\"undefined\"){history.push(\"/tickets\");return;}if(isNil(ticketId))return;try{const{data}=await api.get(\"/messages/\"+ticketId,{params:{pageNumber,selectedQueues:JSON.stringify(selectedQueuesMessage)}});if(currentTicketId.current===ticketId){dispatch({type:\"LOAD_MESSAGES\",payload:data.messages});setHasMore(data.hasMore);setLoading(false);setLoadingMore(false);}if(pageNumber===1&&data.messages.length>1){scrollToBottom();}}catch(err){setLoading(false);toastError(err);setLoadingMore(false);}};fetchMessages();},500);return()=>{clearTimeout(delayDebounceFn);};},[pageNumber,ticketId,selectedQueuesMessage]);useEffect(()=>{if(ticketId===\"undefined\"){return;}const companyId=user.companyId;//    const socket = socketManager.GetSocket();\nconst connectEventMessagesList=()=>{socket.emit(\"joinChatBox\",\"\".concat(ticketId));};const onAppMessageMessagesList=data=>{var _data$message,_data$message$ticket,_data$message$ticket2;if(data.action===\"create\"&&data.ticket.uuid===ticketId){dispatch({type:\"ADD_MESSAGE\",payload:data.message});scrollToBottom();}if(data.action===\"update\"&&(data===null||data===void 0?void 0:(_data$message=data.message)===null||_data$message===void 0?void 0:(_data$message$ticket=_data$message.ticket)===null||_data$message$ticket===void 0?void 0:_data$message$ticket.uuid)===ticketId){dispatch({type:\"UPDATE_MESSAGE\",payload:data.message});}if(data.action==\"delete\"&&((_data$message$ticket2=data.message.ticket)===null||_data$message$ticket2===void 0?void 0:_data$message$ticket2.uuid)===ticketId){dispatch({type:\"DELETE_MESSAGE\",payload:data.messageId});}};socket.on(\"connect\",connectEventMessagesList);socket.on(\"company-\".concat(companyId,\"-appMessage\"),onAppMessageMessagesList);return()=>{socket.emit(\"joinChatBoxLeave\",\"\".concat(ticketId));socket.off(\"connect\",connectEventMessagesList);socket.off(\"company-\".concat(companyId,\"-appMessage\"),onAppMessageMessagesList);};},[ticketId]);const loadMore=()=>{if(loadingMore)return;setLoadingMore(true);setPageNumber(prevPageNumber=>prevPageNumber+1);};const scrollToBottom=()=>{setTimeout(()=>{if(lastMessageRef.current){lastMessageRef.current.scrollIntoView({});}},100);};const handleScroll=e=>{if(!hasMore)return;const{scrollTop}=e.currentTarget;if(scrollTop===0){document.getElementById(\"messagesList\").scrollTop=1;}if(loading){return;}if(scrollTop<50){loadMore();}};const handleOpenMessageOptionsMenu=(e,message)=>{setAnchorEl(e.currentTarget);setSelectedMessage(message);};const handleCloseMessageOptionsMenu=e=>{setAnchorEl(null);};const hanldeReplyMessage=(e,message)=>{//if (ticket.status === \"open\" || ticket.status === \"group\") {\nsetAnchorEl(null);setReplyingMessage(message);//}\n};const checkMessageMedia=message=>{if(message.mediaType===\"locationMessage\"&&message.body.split('|').length>=2){let locationParts=message.body.split('|');let imageLocation=locationParts[0];let linkLocation=locationParts[1];let descriptionLocation=null;if(locationParts.length>2)descriptionLocation=message.body.split('|')[2];return/*#__PURE__*/React.createElement(LocationPreview,{image:imageLocation,link:linkLocation,description:descriptionLocation});}else if(message.mediaType===\"contactMessage\"){var _obj$,_message$ticket,_message$ticket2;let array=message.body.split(\"\\n\");let obj=[];let contact=\"\";for(let index=0;index<array.length;index++){const v=array[index];let values=v.split(\":\");for(let ind=0;ind<values.length;ind++){if(values[ind].indexOf(\"+\")!==-1){obj.push({number:values[ind]});}if(values[ind].indexOf(\"FN\")!==-1){contact=values[ind+1];}}}return/*#__PURE__*/React.createElement(VcardPreview,{contact:contact,numbers:(_obj$=obj[0])===null||_obj$===void 0?void 0:_obj$.number,queueId:message===null||message===void 0?void 0:(_message$ticket=message.ticket)===null||_message$ticket===void 0?void 0:_message$ticket.queueId,whatsappId:message===null||message===void 0?void 0:(_message$ticket2=message.ticket)===null||_message$ticket2===void 0?void 0:_message$ticket2.whatsappId});}else if(message.mediaType===\"image\"){return/*#__PURE__*/React.createElement(ModalImageCors,{imageUrl:message.mediaUrl});}else if(message.mediaType===\"audio\"){return/*#__PURE__*/React.createElement(AudioModal,{url:message.mediaUrl})// <audio controls>\n//   <source src={message.mediaUrl} type=\"audio/ogg\"></source>\n//   {/* <source src={message.mediaUrl} type=\"audio/mp3\"></source> */}\n// </audio>\n;}else if(message.mediaType===\"video\"){return/*#__PURE__*/React.createElement(\"video\",{className:classes.messageMedia,src:message.mediaUrl,controls:true});}else{return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:classes.downloadMedia},/*#__PURE__*/React.createElement(Button,{startIcon:/*#__PURE__*/React.createElement(GetApp,null),variant:\"outlined\",target:\"_blank\",href:message.mediaUrl},\"Download\")),/*#__PURE__*/React.createElement(Divider,null));}};const renderMessageAck=message=>{if(message.ack===0){return/*#__PURE__*/React.createElement(AccessTime,{fontSize:\"small\",className:classes.ackIcons});}else if(message.ack===1){return/*#__PURE__*/React.createElement(Done,{fontSize:\"small\",className:classes.ackIcons});}else if(message.ack===2){return/*#__PURE__*/React.createElement(DoneAll,{fontSize:\"small\",className:classes.ackIcons});}else if(message.ack===3||message.ack===4){return/*#__PURE__*/React.createElement(DoneAll,{fontSize:\"small\",className:message.mediaType===\"audio\"?classes.ackPlayedIcon:classes.ackDoneAllIcon});}else if(message.ack===5){return/*#__PURE__*/React.createElement(DoneAll,{fontSize:\"small\",className:classes.ackDoneAllIcon});}};const renderDailyTimestamps=(message,index)=>{const today=format(new Date(),\"dd/MM/yyyy\");if(index===0){return/*#__PURE__*/React.createElement(\"span\",{className:classes.dailyTimestamp,key:\"timestamp-\".concat(message.id)},/*#__PURE__*/React.createElement(\"div\",{className:classes.dailyTimestampText},today===format(parseISO(messagesList[index].createdAt),\"dd/MM/yyyy\")?\"HOJE\":format(parseISO(messagesList[index].createdAt),\"dd/MM/yyyy\")));}else if(index<messagesList.length-1){let messageDay=parseISO(messagesList[index].createdAt);let previousMessageDay=parseISO(messagesList[index-1].createdAt);if(!isSameDay(messageDay,previousMessageDay)){return/*#__PURE__*/React.createElement(\"span\",{className:classes.dailyTimestamp,key:\"timestamp-\".concat(message.id)},/*#__PURE__*/React.createElement(\"div\",{className:classes.dailyTimestampText},today===format(parseISO(messagesList[index].createdAt),\"dd/MM/yyyy\")?\"HOJE\":format(parseISO(messagesList[index].createdAt),\"dd/MM/yyyy\")));}}else if(index===messagesList.length-1){return/*#__PURE__*/React.createElement(\"div\",{key:\"ref-\".concat(message.id),ref:lastMessageRef,style:{float:\"left\",clear:\"both\"}});}};const renderTicketsSeparator=(message,index)=>{var _messagesList;let lastTicket=(_messagesList=messagesList[index-1])===null||_messagesList===void 0?void 0:_messagesList.ticketId;let currentTicket=message.ticketId;if(lastTicket!==currentTicket&&lastTicket!==undefined){var _message$ticket3;if(message===null||message===void 0?void 0:(_message$ticket3=message.ticket)===null||_message$ticket3===void 0?void 0:_message$ticket3.queue){var _message$ticket4,_message$ticket4$queu,_message$ticket5,_message$ticket5$queu;return/*#__PURE__*/React.createElement(\"span\",{className:classes.currentTick,key:\"timestamp-\".concat(message.id,\"a\")},/*#__PURE__*/React.createElement(\"div\",{className:classes.currentTicktText,style:{backgroundColor:(message===null||message===void 0?void 0:(_message$ticket4=message.ticket)===null||_message$ticket4===void 0?void 0:(_message$ticket4$queu=_message$ticket4.queue)===null||_message$ticket4$queu===void 0?void 0:_message$ticket4$queu.color)||\"grey\"}},\"#\",i18n.t(\"ticketsList.called\"),\" \",message===null||message===void 0?void 0:message.ticketId,\" - \",message===null||message===void 0?void 0:(_message$ticket5=message.ticket)===null||_message$ticket5===void 0?void 0:(_message$ticket5$queu=_message$ticket5.queue)===null||_message$ticket5$queu===void 0?void 0:_message$ticket5$queu.name));}else{return/*#__PURE__*/React.createElement(\"span\",{className:classes.currentTick,key:\"timestamp-\".concat(message.id,\"b\")},/*#__PURE__*/React.createElement(\"div\",{className:classes.currentTicktText,style:{backgroundColor:\"grey\"}},\"#\",i18n.t(\"ticketsList.called\"),\" \",message.ticketId,\" - \",i18n.t(\"ticketsList.noQueue\")));}}};const renderMessageDivider=(message,index)=>{if(index<messagesList.length&&index>0){let messageUser=messagesList[index].fromMe;let previousMessageUser=messagesList[index-1].fromMe;if(messageUser!==previousMessageUser){return/*#__PURE__*/React.createElement(\"span\",{style:{marginTop:16},key:\"divider-\".concat(message.id)});}}};const path=require('path');const renderQuotedMessage=message=>{var _message$quotedMsg,_message$quotedMsg2,_message$quotedMsg3,_message$quotedMsg3$c,_message$quotedMsg4,_message$quotedMsg5;return/*#__PURE__*/React.createElement(\"div\",{className:clsx(classes.quotedContainerLeft,{[classes.quotedContainerRight]:message.fromMe})},/*#__PURE__*/React.createElement(\"span\",{className:clsx(classes.quotedSideColorLeft,{[classes.quotedSideColorRight]:(_message$quotedMsg=message.quotedMsg)===null||_message$quotedMsg===void 0?void 0:_message$quotedMsg.fromMe})}),/*#__PURE__*/React.createElement(\"div\",{className:classes.quotedMsg},!((_message$quotedMsg2=message.quotedMsg)===null||_message$quotedMsg2===void 0?void 0:_message$quotedMsg2.fromMe)&&/*#__PURE__*/React.createElement(\"span\",{className:classes.messageContactName},(_message$quotedMsg3=message.quotedMsg)===null||_message$quotedMsg3===void 0?void 0:(_message$quotedMsg3$c=_message$quotedMsg3.contact)===null||_message$quotedMsg3$c===void 0?void 0:_message$quotedMsg3$c.name),message.quotedMsg.mediaType===\"audio\"&&/*#__PURE__*/React.createElement(\"div\",{className:classes.downloadMedia},/*#__PURE__*/React.createElement(AudioModal,{url:message.quotedMsg.mediaUrl})),message.quotedMsg.mediaType===\"video\"&&/*#__PURE__*/React.createElement(\"video\",{className:classes.messageMedia,src:message.quotedMsg.mediaUrl,controls:true}),message.quotedMsg.mediaType===\"contactMessage\"&&\"Contato\",message.quotedMsg.mediaType===\"application\"&&/*#__PURE__*/React.createElement(\"div\",{className:classes.downloadMedia},/*#__PURE__*/React.createElement(Button,{startIcon:/*#__PURE__*/React.createElement(GetApp,null)// color=\"primary\"\n,variant:\"outlined\",target:\"_blank\",href:message.quotedMsg.mediaUrl},\"Download\")),message.quotedMsg.mediaType===\"image\"&&/*#__PURE__*/React.createElement(ModalImageCors,{imageUrl:message.quotedMsg.mediaUrl})||((_message$quotedMsg4=message.quotedMsg)===null||_message$quotedMsg4===void 0?void 0:_message$quotedMsg4.body),!message.quotedMsg.mediaType===\"image\"&&((_message$quotedMsg5=message.quotedMsg)===null||_message$quotedMsg5===void 0?void 0:_message$quotedMsg5.body)));};const handleDrag=event=>{event.preventDefault();event.stopPropagation();if(event.type===\"dragenter\"||event.type===\"dragover\"){setDragActive(true);}else if(event.type===\"dragleave\"){setDragActive(false);}};const isYouTubeLink=url=>{const youtubeRegex=/(?:youtube\\.com\\/(?:[^\\/\\n\\s]+\\/\\S+\\/|(?:v|e(?:mbed)?)\\/|\\S*?[?&]v=)|youtu\\.be\\/)([a-zA-Z0-9_-]{11})/;return youtubeRegex.test(url);};const handleDrop=event=>{event.preventDefault();event.stopPropagation();setDragActive(false);if(event.dataTransfer.files&&event.dataTransfer.files[0]){if(onDrop){onDrop(event.dataTransfer.files);}}};const xmlRegex=/<([^>]+)>/g;const boldRegex=/\\*(.*?)\\*/g;const formatXml=xmlString=>{// Verifica se o XML contÃ©m a assinatura com nome do atendente\nif(boldRegex.test(xmlString)){// Formata o texto dentro da assinatura em negrito\nxmlString=xmlString.replace(boldRegex,\"**$1**\");}return xmlString;};const renderMessages=()=>{if(messagesList.length>0){const viewMessagesList=messagesList.map((message,index)=>{if(message.mediaType===\"call_log\"){var _message$contact;return/*#__PURE__*/React.createElement(React.Fragment,{key:message.id},renderDailyTimestamps(message,index),renderTicketsSeparator(message,index),renderMessageDivider(message,index),/*#__PURE__*/React.createElement(\"div\",{className:classes.messageCenter},/*#__PURE__*/React.createElement(IconButton,{variant:\"contained\",size:\"small\",id:\"messageActionsButton\",disabled:message.isDeleted,className:classes.messageActionsButton,onClick:e=>handleOpenMessageOptionsMenu(e,message)},/*#__PURE__*/React.createElement(ExpandMore,null)),isGroup&&/*#__PURE__*/React.createElement(\"span\",{className:classes.messageContactName},(_message$contact=message.contact)===null||_message$contact===void 0?void 0:_message$contact.name),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 20 17\",width:\"20\",height:\"17\"},/*#__PURE__*/React.createElement(\"path\",{fill:\"#df3333\",d:\"M18.2 12.1c-1.5-1.8-5-2.7-8.2-2.7s-6.7 1-8.2 2.7c-.7.8-.3 2.3.2 2.8.2.2.3.3.5.3 1.4 0 3.6-.7 3.6-.7.5-.2.8-.5.8-1v-1.3c.7-1.2 5.4-1.2 6.4-.1l.1.1v1.3c0 .2.1.4.2.6.1.2.3.3.5.4 0 0 2.2.7 3.6.7.2 0 1.4-2 .5-3.1zM5.4 3.2l4.7 4.6 5.8-5.7-.9-.8L10.1 6 6.4 2.3h2.5V1H4.1v4.8h1.3V3.2z\"})),\" \",/*#__PURE__*/React.createElement(\"span\",null,i18n.t(\"ticketsList.missedCall\"),\" \",format(parseISO(message.createdAt),\"HH:mm\")))));}if(!message.fromMe){var _message$queue,_message$contact2,_message$contact3;return/*#__PURE__*/React.createElement(React.Fragment,{key:message.id},renderDailyTimestamps(message,index),renderTicketsSeparator(message,index),renderMessageDivider(message,index),/*#__PURE__*/React.createElement(\"div\",{className:classes.messageLeft,title:message.queueId&&((_message$queue=message.queue)===null||_message$queue===void 0?void 0:_message$queue.name),onDoubleClick:e=>hanldeReplyMessage(e,message)},showSelectMessageCheckbox&&/*#__PURE__*/React.createElement(SelectMessageCheckbox// showSelectMessageCheckbox={showSelectMessageCheckbox}\n,{message:message// selectedMessagesList={selectedMessagesList}\n// setSelectedMessagesList={setSelectedMessagesList}\n}),/*#__PURE__*/React.createElement(IconButton,{variant:\"contained\",size:\"small\",id:\"messageActionsButton\",disabled:message.isDeleted,className:classes.messageActionsButton,onClick:e=>handleOpenMessageOptionsMenu(e,message)},/*#__PURE__*/React.createElement(ExpandMore,null)),message.isForwarded&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{className:classes.forwardMessage},/*#__PURE__*/React.createElement(Reply,{style:{color:\"grey\",transform:'scaleX(-1)'}}),\" Encaminhada\"),/*#__PURE__*/React.createElement(\"br\",null)),isGroup&&/*#__PURE__*/React.createElement(\"span\",{className:classes.messageContactName},(_message$contact2=message.contact)===null||_message$contact2===void 0?void 0:_message$contact2.name),isYouTubeLink(message.body)&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(YouTubePreview,{videoUrl:message.body})),!lgpdDeleteMessage&&message.isDeleted&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{className:classes.deletedMessage},\"\\uD83D\\uDEAB Essa mensagem foi apagada pelo contato \\xA0\")),(message.mediaUrl||message.mediaType===\"locationMessage\"||message.mediaType===\"contactMessage\"//|| message.mediaType === \"multi_vcard\" \n)&&checkMessageMedia(message),/*#__PURE__*/React.createElement(\"div\",{className:clsx(classes.textContentItem,{[classes.textContentItemDeleted]:message.isDeleted})},message.quotedMsg&&renderQuotedMessage(message),(message.mediaUrl!==null&&(message.mediaType===\"image\"||message.mediaType===\"video\")&&path.basename(message.mediaUrl).trim()!==message.body.trim()||message.mediaType!==\"audio\"&&message.mediaType!==\"image\"&&message.mediaType!==\"video\"&&message.mediaType!=\"reactionMessage\"&&message.mediaType!=\"locationMessage\"&&message.mediaType!==\"contactMessage\")&&/*#__PURE__*/React.createElement(React.Fragment,null,xmlRegex.test(message.body)&&/*#__PURE__*/React.createElement(\"span\",null,message.body),!xmlRegex.test(message.body)&&/*#__PURE__*/React.createElement(MarkdownWrapper,null,lgpdDeleteMessage&&message.isDeleted?\"ðŸš« _Mensagem apagada_ \":message.body)),message.quotedMsg&&message.mediaType===\"reactionMessage\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"span\",{style:{marginLeft:\"0px\"}},/*#__PURE__*/React.createElement(MarkdownWrapper,null,\"\"+(message===null||message===void 0?void 0:(_message$contact3=message.contact)===null||_message$contact3===void 0?void 0:_message$contact3.name)+\" reagiu... \"+message.body))),/*#__PURE__*/React.createElement(\"span\",{className:classes.timestamp},message.isEdited?\"Editada \"+format(parseISO(message.createdAt),\"HH:mm\"):format(parseISO(message.createdAt),\"HH:mm\")))));}else{var _message$queue2;return/*#__PURE__*/React.createElement(React.Fragment,{key:message.id},renderDailyTimestamps(message,index),renderTicketsSeparator(message,index),renderMessageDivider(message,index),/*#__PURE__*/React.createElement(\"div\",{className:message.isPrivate?classes.messageRightPrivate:classes.messageRight,title:message.queueId&&((_message$queue2=message.queue)===null||_message$queue2===void 0?void 0:_message$queue2.name),onDoubleClick:e=>hanldeReplyMessage(e,message)},showSelectMessageCheckbox&&/*#__PURE__*/React.createElement(SelectMessageCheckbox// showSelectMessageCheckbox={showSelectMessageCheckbox}\n,{message:message// selectedMessagesList={selectedMessagesList}\n// setSelectedMessagesList={setSelectedMessagesList}\n}),/*#__PURE__*/React.createElement(IconButton,{variant:\"contained\",size:\"small\",id:\"messageActionsButton\",disabled:message.isDeleted,className:classes.messageActionsButton,onClick:e=>handleOpenMessageOptionsMenu(e,message)},/*#__PURE__*/React.createElement(ExpandMore,null)),message.isForwarded&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{className:classes.forwardMessage},/*#__PURE__*/React.createElement(Reply,{style:{color:\"grey\",transform:'scaleX(-1)'}}),\" Encaminhada\"),/*#__PURE__*/React.createElement(\"br\",null)),isYouTubeLink(message.body)&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(YouTubePreview,{videoUrl:message.body})),!lgpdDeleteMessage&&message.isDeleted&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{className:classes.deletedMessage},\"\\uD83D\\uDEAB Essa mensagem foi apagada \\xA0\")),(message.mediaUrl||message.mediaType===\"locationMessage\"||message.mediaType===\"contactMessage\"//|| message.mediaType === \"multi_vcard\" \n)&&checkMessageMedia(message),/*#__PURE__*/React.createElement(\"div\",{className:clsx(classes.textContentItem,{[classes.textContentItemDeleted]:message.isDeleted})},message.quotedMsg&&renderQuotedMessage(message),(message.mediaType===\"image\"||message.mediaType===\"video\")&&path.basename(message.mediaUrl)===message.body||message.mediaType!==\"audio\"&&message.mediaType!=\"reactionMessage\"&&message.mediaType!=\"locationMessage\"&&message.mediaType!==\"contactMessage\"&&/*#__PURE__*/React.createElement(React.Fragment,null,xmlRegex.test(message.body)&&/*#__PURE__*/React.createElement(\"div\",null,formatXml(message.body)),!xmlRegex.test(message.body)&&/*#__PURE__*/React.createElement(MarkdownWrapper,null,message.body)),message.quotedMsg&&message.mediaType===\"reactionMessage\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"span\",{style:{marginLeft:\"0px\"}},/*#__PURE__*/React.createElement(MarkdownWrapper,null,\"VocÃª reagiu... \"+message.body))),/*#__PURE__*/React.createElement(\"span\",{className:classes.timestamp},message.isEdited?\"Editada \"+format(parseISO(message.createdAt),\"HH:mm\"):format(parseISO(message.createdAt),\"HH:mm\"),renderMessageAck(message)))));}});return viewMessagesList;}else{return/*#__PURE__*/React.createElement(\"div\",null,\"Diga ol\\xE1 para seu novo contato!\");}};return/*#__PURE__*/React.createElement(\"div\",{className:classes.messagesListWrapper,onDragEnter:handleDrag},dragActive&&/*#__PURE__*/React.createElement(\"div\",{className:classes.dragElement,onDragEnter:handleDrag,onDragLeave:handleDrag,onDragOver:handleDrag,onDrop:handleDrop},\"Solte o arquivo aqui\"),/*#__PURE__*/React.createElement(MessageOptionsMenu,{message:selectedMessage,anchorEl:anchorEl,menuOpen:messageOptionsMenuOpen,handleClose:handleCloseMessageOptionsMenu,isGroup:isGroup,whatsappId:whatsappId,queueId:queueId}),/*#__PURE__*/React.createElement(\"div\",{id:\"messagesList\",className:classes.messagesList,onScroll:handleScroll},messagesList.length>0?renderMessages():[]),channel!==\"whatsapp\"&&channel!==undefined&&/*#__PURE__*/React.createElement(\"div\",{style:{width:\"100%\",display:\"flex\",padding:\"10px\",alignItems:\"center\",backgroundColor:\"#E1F3FB\"}},channel===\"facebook\"?/*#__PURE__*/React.createElement(Facebook,null):/*#__PURE__*/React.createElement(Instagram,null),/*#__PURE__*/React.createElement(\"span\",null,\"Voc\\xEA tem 24h para responder ap\\xF3s receber uma mensagem, de acordo com as pol\\xEDticas do Facebook.\")),loading&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(CircularProgress,{className:classes.circleLoading})));};export default MessagesList;","map":{"version":3,"names":["React","useContext","useState","useEffect","useReducer","useRef","memo","useCallback","isSameDay","parseISO","format","clsx","isNil","blue","green","red","Button","CircularProgress","Divider","IconButton","makeStyles","Badge","AccessTime","Block","Done","DoneAll","ExpandMore","GetApp","Facebook","Instagram","Reply","Close","MarkdownWrapper","VcardPreview","LocationPreview","ModalImageCors","MessageOptionsMenu","whatsBackground","whatsBackgroundDark","YouTubePreview","ReplyMessageContext","ForwardMessageContext","api","toastError","i18n","SelectMessageCheckbox","useCompanySettings","AuthContext","QueueSelectedContext","AudioModal","messages","useParams","useHistory","useStyles","theme","messagesListWrapper","overflow","position","display","flexDirection","flexGrow","width","minWidth","minHeight","currentTick","alignItems","textAlign","alignSelf","backgroundColor","palette","primary","main","margin","borderRadius","boxShadow","currentTicktText","color","fontWeight","padding","marginLeft","messagesList","backgroundImage","mode","concat","overflowY","scrollbarStyles","dragElement","background","height","zIndex","fontSize","border","justifyContent","circleLoading","opacity","top","left","marginTop","messageLeft","marginRight","maxWidth","right","whiteSpace","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","paddingLeft","paddingRight","paddingTop","paddingBottom","quotedContainerLeft","quotedMsg","quotedSideColorLeft","flex","messageRight","messageRightPrivate","quotedContainerRight","quotedMsgRight","quotedSideColorRight","messageActionsButton","messageContactName","textContentItem","overflowWrap","textContentItemDeleted","fontStyle","messageMedia","objectFit","timestamp","bottom","forwardMessage","dailyTimestamp","dailyTimestampText","ackIcons","verticalAlign","deletedIcon","ackDoneAllIcon","ackPlayedIcon","downloadMedia","light","dark","messageCenter","alignContent","deletedMessage","reducer","state","action","type","payload","newMessages","forEach","message","messageIndex","findIndex","m","id","push","newMessage","messageToUpdate","MessagesList","_ref","isGroup","onDrop","whatsappId","queueId","channel","classes","dispatch","pageNumber","setPageNumber","hasMore","setHasMore","loading","setLoading","loadingMore","setLoadingMore","history","lastMessageRef","selectedMessage","setSelectedMessage","setReplyingMessage","anchorEl","setAnchorEl","messageOptionsMenuOpen","Boolean","ticketId","currentTicketId","getAll","dragActive","setDragActive","lgpdDeleteMessage","setLGPDDeleteMessage","selectedQueuesMessage","showSelectMessageCheckbox","user","socket","companyId","fetchData","settings","settinglgpdDeleteMessage","settingEnableLGPD","key","value","Object","entries","current","delayDebounceFn","setTimeout","fetchMessages","data","get","params","selectedQueues","JSON","stringify","length","scrollToBottom","err","clearTimeout","connectEventMessagesList","emit","onAppMessageMessagesList","_data$message","_data$message$ticket","_data$message$ticket2","ticket","uuid","messageId","on","off","loadMore","prevPageNumber","scrollIntoView","handleScroll","e","scrollTop","currentTarget","document","getElementById","handleOpenMessageOptionsMenu","handleCloseMessageOptionsMenu","hanldeReplyMessage","checkMessageMedia","mediaType","body","split","locationParts","imageLocation","linkLocation","descriptionLocation","createElement","image","link","description","_obj$","_message$ticket","_message$ticket2","array","obj","contact","index","v","values","ind","indexOf","number","numbers","imageUrl","mediaUrl","url","className","src","controls","Fragment","startIcon","variant","target","href","renderMessageAck","ack","renderDailyTimestamps","today","Date","createdAt","messageDay","previousMessageDay","ref","style","float","clear","renderTicketsSeparator","_messagesList","lastTicket","currentTicket","undefined","_message$ticket3","queue","_message$ticket4","_message$ticket4$queu","_message$ticket5","_message$ticket5$queu","t","name","renderMessageDivider","messageUser","fromMe","previousMessageUser","path","require","renderQuotedMessage","_message$quotedMsg","_message$quotedMsg2","_message$quotedMsg3","_message$quotedMsg3$c","_message$quotedMsg4","_message$quotedMsg5","handleDrag","event","preventDefault","stopPropagation","isYouTubeLink","youtubeRegex","test","handleDrop","dataTransfer","files","xmlRegex","boldRegex","formatXml","xmlString","replace","renderMessages","viewMessagesList","map","_message$contact","size","disabled","isDeleted","onClick","xmlns","viewBox","fill","d","_message$queue","_message$contact2","_message$contact3","title","onDoubleClick","isForwarded","transform","videoUrl","basename","trim","isEdited","_message$queue2","isPrivate","onDragEnter","onDragLeave","onDragOver","menuOpen","handleClose","onScroll"],"sources":["C:/ProjectsCode/ZapRun/ZapRun/frontend/src/components/MessagesList/index.js"],"sourcesContent":["import React, { useContext, useState, useEffect, useReducer, useRef, memo, useCallback } from \"react\";\r\nimport { isSameDay, parseISO, format } from \"date-fns\";\r\nimport clsx from \"clsx\";\r\nimport { isNil } from \"lodash\";\r\nimport { blue, green, red } from \"@material-ui/core/colors\";\r\nimport {\r\n  Button,\r\n  CircularProgress,\r\n  Divider,\r\n  IconButton,\r\n  makeStyles,\r\n  Badge\r\n} from \"@material-ui/core\";\r\n\r\nimport {\r\n  AccessTime,\r\n  Block,\r\n  Done,\r\n  DoneAll,\r\n  ExpandMore,\r\n  GetApp,\r\n  Facebook,\r\n  Instagram,\r\n  Reply,\r\n  Close,\r\n} from \"@material-ui/icons\";\r\n\r\nimport MarkdownWrapper from \"../MarkdownWrapper\";\r\nimport VcardPreview from \"../VcardPreview\";\r\nimport LocationPreview from \"../LocationPreview\";\r\nimport ModalImageCors from \"../ModalImageCors\";\r\nimport MessageOptionsMenu from \"../MessageOptionsMenu\";\r\nimport whatsBackground from \"../../assets/wa-background.png\";\r\nimport whatsBackgroundDark from \"../../assets/wa-background-dark.png\";\r\nimport YouTubePreview from \"../ModalYoutubeCors\";\r\n\r\nimport { ReplyMessageContext } from \"../../context/ReplyingMessage/ReplyingMessageContext\";\r\nimport { ForwardMessageContext } from \"../../context/ForwarMessage/ForwardMessageContext\";\r\n\r\nimport api from \"../../services/api\";\r\nimport toastError from \"../../errors/toastError\";\r\n// import { SocketContext } from \"../../context/Socket/SocketContext\";\r\nimport { i18n } from \"../../translate/i18n\";\r\nimport SelectMessageCheckbox from \"./SelectMessageCheckbox\";\r\nimport useCompanySettings from \"../../hooks/useSettings/companySettings\";\r\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\r\nimport { QueueSelectedContext } from \"../../context/QueuesSelected/QueuesSelectedContext\";\r\nimport AudioModal from \"../AudioModal\";\r\nimport { messages } from \"../../translate/languages\";\r\nimport { useParams, useHistory } from 'react-router-dom';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  messagesListWrapper: {\r\n    overflow: \"hidden\",\r\n    position: \"relative\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    flexGrow: 1,\r\n    width: \"100%\",\r\n    minWidth: 300,\r\n    minHeight: 200,\r\n  },\r\n\r\n  currentTick: {\r\n    alignItems: \"center\",\r\n    textAlign: \"center\",\r\n    alignSelf: \"center\",\r\n    width: \"95%\",\r\n    backgroundColor: theme.palette.primary.main,\r\n    margin: \"10px\",\r\n    borderRadius: \"10px\",\r\n    boxShadow: \"1px 5px 10px #b3b3b3\",\r\n  },\r\n\r\n  currentTicktText: {\r\n    color: theme.palette.primary,\r\n    fontWeight: 'bold',\r\n    padding: 8,\r\n    alignSelf: \"center\",\r\n    marginLeft: \"0px\",\r\n  },\r\n\r\n  messagesList: {\r\n    backgroundImage: theme.mode === 'light' ? `url(${whatsBackground})` : `url(${whatsBackgroundDark})`,\r\n    backgroundColor: theme.mode === 'light' ? \"transparent\" : \"#0b0b0d\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    flexGrow: 1,\r\n    padding: \"20px 20px 30px 20px\",\r\n    overflowY: \"scroll\",\r\n    ...theme.scrollbarStyles,\r\n  },\r\n  dragElement: {\r\n    background: 'rgba(255, 255, 255, 0.8)',\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    zIndex: 999999,\r\n    textAlign: \"center\",\r\n    fontSize: \"3em\",\r\n    border: \"5px dashed #333\",\r\n    color: '#333',\r\n    display: \"flex\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\"\r\n  },\r\n  circleLoading: {\r\n    color: blue[500],\r\n    position: \"absolute\",\r\n    opacity: \"70%\",\r\n    top: 0,\r\n    left: \"50%\",\r\n    marginTop: 12,\r\n  },\r\n\r\n  messageLeft: {\r\n    marginRight: 20,\r\n    marginTop: 2,\r\n    minWidth: 100,\r\n    maxWidth: 600,\r\n    height: \"auto\",\r\n    display: \"block\",\r\n    position: \"relative\",\r\n    \"&:hover #messageActionsButton\": {\r\n      display: \"flex\",\r\n      position: \"absolute\",\r\n      top: 0,\r\n      right: 0,\r\n    },\r\n\r\n    whiteSpace: \"pre-wrap\",\r\n    backgroundColor: theme.mode === 'light' ? \"#ffffff\" : \"#202c33\",\r\n    color: theme.mode === 'light' ? \"#303030\" : \"#ffffff\",\r\n    alignSelf: \"flex-start\",\r\n    borderTopLeftRadius: 0,\r\n    borderTopRightRadius: 8,\r\n    borderBottomLeftRadius: 8,\r\n    borderBottomRightRadius: 8,\r\n    paddingLeft: 5,\r\n    paddingRight: 5,\r\n    paddingTop: 5,\r\n    paddingBottom: 0,\r\n    boxShadow: theme.mode === 'light' ? \"0 1px 1px #b3b3b3\" : \"0 1px 1px #000000\"\r\n  },\r\n\r\n  quotedContainerLeft: {\r\n    margin: \"-3px -80px 6px -6px\",\r\n    overflow: \"hidden\",\r\n    backgroundColor: theme.mode === 'light' ? \"#f0f0f0\" : \"#1d282f\",\r\n    borderRadius: \"7.5px\",\r\n    display: \"flex\",\r\n    position: \"relative\",\r\n  },\r\n\r\n  quotedMsg: {\r\n    padding: 10,\r\n    maxWidth: 300,\r\n    height: \"auto\",\r\n    display: \"block\",\r\n    whiteSpace: \"pre-wrap\",\r\n    overflow: \"hidden\",\r\n  },\r\n\r\n  quotedSideColorLeft: {\r\n    flex: \"none\",\r\n    width: \"4px\",\r\n    backgroundColor: \"#388aff\",\r\n  },\r\n\r\n  messageRight: {\r\n    marginLeft: 20,\r\n    marginTop: 2,\r\n    minWidth: 100,\r\n    maxWidth: 600,\r\n    height: \"auto\",\r\n    display: \"block\",\r\n    position: \"relative\",\r\n    \"&:hover #messageActionsButton\": {\r\n      display: \"flex\",\r\n      position: \"absolute\",\r\n      top: 0,\r\n      right: 0,\r\n    },\r\n    whiteSpace: \"pre-wrap\",\r\n    backgroundColor: theme.mode === 'light' ? \"#dcf8c6\" : \"#005c4b\",\r\n    color: theme.mode === 'light' ? \"#303030\" : \"#ffffff\",\r\n    alignSelf: \"flex-end\",\r\n    borderTopLeftRadius: 8,\r\n    borderTopRightRadius: 8,\r\n    borderBottomLeftRadius: 8,\r\n    borderBottomRightRadius: 0,\r\n    paddingLeft: 5,\r\n    paddingRight: 5,\r\n    paddingTop: 5,\r\n    paddingBottom: 0,\r\n    boxShadow: theme.mode === 'light' ? \"0 1px 1px #b3b3b3\" : \"0 1px 1px #000000\"\r\n  },\r\n\r\n  messageRightPrivate: {\r\n    marginLeft: 20,\r\n    marginTop: 2,\r\n    minWidth: 100,\r\n    maxWidth: 600,\r\n    height: \"auto\",\r\n    display: \"block\",\r\n    position: \"relative\",\r\n    \"&:hover #messageActionsButton\": {\r\n      display: \"flex\",\r\n      position: \"absolute\",\r\n      top: 0,\r\n      right: 0,\r\n    },\r\n    whiteSpace: \"pre-wrap\",\r\n    backgroundColor: \"#F0E68C\",\r\n    color: \"#303030\",\r\n    alignSelf: \"flex-end\",\r\n    borderTopLeftRadius: 8,\r\n    borderTopRightRadius: 8,\r\n    borderBottomLeftRadius: 8,\r\n    borderBottomRightRadius: 0,\r\n    paddingLeft: 5,\r\n    paddingRight: 5,\r\n    paddingTop: 5,\r\n    paddingBottom: 0,\r\n    boxShadow: theme.mode === 'light' ? \"0 1px 1px #b3b3b3\" : \"0 1px 1px #000000\"\r\n  },\r\n\r\n  quotedContainerRight: {\r\n    margin: \"-3px -80px 6px -6px\",\r\n    overflowY: \"hidden\",\r\n    backgroundColor: theme.mode === 'light' ? \"#cfe9ba\" : \"#025144\",\r\n    borderRadius: \"7.5px\",\r\n    display: \"flex\",\r\n    position: \"relative\",\r\n  },\r\n\r\n  quotedMsgRight: {\r\n    padding: 10,\r\n    maxWidth: 300,\r\n    height: \"auto\",\r\n    whiteSpace: \"pre-wrap\",\r\n  },\r\n\r\n  quotedSideColorRight: {\r\n    flex: \"none\",\r\n    width: \"4px\",\r\n    backgroundColor: \"#35cd96\",\r\n  },\r\n\r\n  messageActionsButton: {\r\n    display: \"none\",\r\n    position: \"relative\",\r\n    color: \"#999\",\r\n    zIndex: 1,\r\n    backgroundColor: \"inherit\",\r\n    opacity: \"90%\",\r\n    \"&:hover, &.Mui-focusVisible\": { backgroundColor: \"inherit\" },\r\n  },\r\n\r\n  messageContactName: {\r\n    display: \"flex\",\r\n    color: \"#6bcbef\",\r\n    fontWeight: 500,\r\n  },\r\n\r\n  textContentItem: {\r\n    overflowWrap: \"break-word\",\r\n    padding: \"3px 80px 6px 6px\",\r\n  },\r\n\r\n  textContentItemDeleted: {\r\n    fontStyle: \"italic\",\r\n    color: \"rgba(0, 0, 0, 0.36)\",\r\n    overflowWrap: \"break-word\",\r\n    padding: \"3px 80px 6px 6px\",\r\n  },\r\n\r\n  messageMedia: {\r\n    objectFit: \"cover\",\r\n    width: 400,\r\n    height: \"auto\",\r\n    borderTopLeftRadius: 8,\r\n    borderTopRightRadius: 8,\r\n    borderBottomLeftRadius: 8,\r\n    borderBottomRightRadius: 8,\r\n  },\r\n\r\n  timestamp: {\r\n    fontSize: 11,\r\n    position: \"absolute\",\r\n    bottom: 0,\r\n    right: 5,\r\n    color: \"#999\",\r\n  },\r\n\r\n  forwardMessage: {\r\n    fontSize: 12,\r\n    fontStyle: \"italic\",\r\n    position: \"absolute\",\r\n    top: 0,\r\n    left: 5,\r\n    color: \"#999\",\r\n    display: \"flex\",\r\n    alignItems: \"center\"\r\n  },\r\n\r\n  dailyTimestamp: {\r\n    alignItems: \"center\",\r\n    textAlign: \"center\",\r\n    alignSelf: \"center\",\r\n    width: \"110px\",\r\n    backgroundColor: \"#e1f3fb\",\r\n    margin: \"10px\",\r\n    borderRadius: \"10px\",\r\n    boxShadow: \"0 1px 1px #b3b3b3\",\r\n  },\r\n\r\n  dailyTimestampText: {\r\n    color: \"#808888\",\r\n    padding: 8,\r\n    alignSelf: \"center\",\r\n    marginLeft: \"0px\",\r\n  },\r\n\r\n  ackIcons: {\r\n    fontSize: 18,\r\n    verticalAlign: \"middle\",\r\n    marginLeft: 4,\r\n  },\r\n\r\n  deletedIcon: {\r\n    fontSize: 18,\r\n    verticalAlign: \"middle\",\r\n    marginRight: 4,\r\n  },\r\n\r\n  ackDoneAllIcon: {\r\n    color: blue[500],\r\n    fontSize: 18,\r\n    verticalAlign: \"middle\",\r\n    marginLeft: 4,\r\n  },\r\n\r\n  ackPlayedIcon: {\r\n    color: green[500],\r\n    fontSize: 18,\r\n    verticalAlign: \"middle\",\r\n    marginLeft: 4,\r\n  },\r\n  downloadMedia: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    backgroundColor: \"inherit\",\r\n    padding: 10,\r\n    color: theme.mode === \"light\" ? theme.palette.light : theme.palette.dark,\r\n  },\r\n\r\n  messageCenter: {\r\n    marginTop: 5,\r\n    alignItems: \"center\",\r\n    verticalAlign: \"center\",\r\n    alignContent: \"center\",\r\n    backgroundColor: \"#E1F5FEEB\",\r\n    fontSize: \"12px\",\r\n    minWidth: 100,\r\n    maxWidth: 270,\r\n    color: \"#272727\",\r\n    borderTopLeftRadius: 0,\r\n    borderTopRightRadius: 8,\r\n    borderBottomLeftRadius: 8,\r\n    borderBottomRightRadius: 8,\r\n    paddingLeft: 5,\r\n    paddingRight: 5,\r\n    paddingTop: 5,\r\n    paddingBottom: 0,\r\n    boxShadow: \"0 1px 1px #b3b3b3\",\r\n  },\r\n\r\n  deletedMessage: {\r\n    color: '#f55d65'\r\n  }\r\n}));\r\n\r\nconst reducer = (state, action) => {\r\n  if (action.type === \"LOAD_MESSAGES\") {\r\n    const messages = action.payload;\r\n    const newMessages = [];\r\n\r\n    messages.forEach((message) => {\r\n\r\n      const messageIndex = state.findIndex((m) => m.id === message.id);\r\n      if (messageIndex !== -1) {\r\n        state[messageIndex] = message;\r\n      } else {\r\n        newMessages.push(message);\r\n      }\r\n    });\r\n\r\n    return [...newMessages, ...state];\r\n  }\r\n\r\n  if (action.type === \"ADD_MESSAGE\") {\r\n    const newMessage = action.payload;\r\n    const messageIndex = state.findIndex((m) => m.id === newMessage.id);\r\n\r\n    if (messageIndex !== -1) {\r\n      state[messageIndex] = newMessage;\r\n    } else {\r\n      state.push(newMessage);\r\n    }\r\n\r\n    return [...state];\r\n  }\r\n\r\n  if (action.type === \"UPDATE_MESSAGE\") {\r\n    const messageToUpdate = action.payload;\r\n    const messageIndex = state.findIndex((m) => m.id === messageToUpdate.id);\r\n\r\n    if (messageIndex !== -1) {\r\n      state[messageIndex] = messageToUpdate;\r\n    }\r\n\r\n    return [...state];\r\n  }\r\n\r\n  if (action.type === \"RESET\") {\r\n    return [];\r\n  }\r\n};\r\n\r\nconst MessagesList = ({\r\n  isGroup,\r\n  onDrop,\r\n  whatsappId,\r\n  queueId,\r\n  channel\r\n}) => {\r\n  const classes = useStyles();\r\n  const [messagesList, dispatch] = useReducer(reducer, []);\r\n  const [pageNumber, setPageNumber] = useState(1);\r\n  const [hasMore, setHasMore] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingMore, setLoadingMore] = useState(false);\r\n  const history = useHistory();\r\n  const lastMessageRef = useRef();\r\n\r\n  const [selectedMessage, setSelectedMessage] = useState({});\r\n  const { setReplyingMessage } = useContext(ReplyMessageContext);\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n  const messageOptionsMenuOpen = Boolean(anchorEl);\r\n  const { ticketId } = useParams();\r\n\r\n  const currentTicketId = useRef(ticketId);\r\n  const { getAll } = useCompanySettings();\r\n  const [dragActive, setDragActive] = useState(false);\r\n\r\n  const [lgpdDeleteMessage, setLGPDDeleteMessage] = useState(false);\r\n  const { selectedQueuesMessage } = useContext(QueueSelectedContext);\r\n\r\n  const { showSelectMessageCheckbox } = useContext(ForwardMessageContext);\r\n\r\n  const { user, socket } = useContext(AuthContext);\r\n\r\n  const companyId = user.companyId;\r\n\r\n  useEffect(() => {\r\n\r\n    async function fetchData() {\r\n\r\n      const settings = await getAll(companyId);\r\n\r\n      let settinglgpdDeleteMessage;\r\n      let settingEnableLGPD;\r\n\r\n      for (const [key, value] of Object.entries(settings)) {\r\n\r\n        if (key === \"lgpdDeleteMessage\") settinglgpdDeleteMessage = value\r\n        if (key === \"enableLGPD\") settingEnableLGPD = value\r\n      }\r\n      if (settingEnableLGPD === \"enabled\" && settinglgpdDeleteMessage === \"enabled\") {\r\n        setLGPDDeleteMessage(true);\r\n      }\r\n    }\r\n    fetchData();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    dispatch({ type: \"RESET\" });\r\n    setPageNumber(1);\r\n\r\n    currentTicketId.current = ticketId;\r\n  }, [ticketId, selectedQueuesMessage]);\r\n\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    const delayDebounceFn = setTimeout(() => {\r\n      const fetchMessages = async () => {\r\n        if (ticketId === \"undefined\") {\r\n          history.push(\"/tickets\");\r\n          return;\r\n        }\r\n        if (isNil(ticketId)) return;\r\n        try {\r\n          const { data } = await api.get(\"/messages/\" + ticketId, {\r\n            params: { pageNumber, selectedQueues: JSON.stringify(selectedQueuesMessage) },\r\n          });\r\n\r\n          if (currentTicketId.current === ticketId) {\r\n            dispatch({ type: \"LOAD_MESSAGES\", payload: data.messages });\r\n            setHasMore(data.hasMore);\r\n            setLoading(false);\r\n            setLoadingMore(false);\r\n          }\r\n\r\n          if (pageNumber === 1 && data.messages.length > 1) {\r\n            scrollToBottom();\r\n          }\r\n        } catch (err) {\r\n          setLoading(false);\r\n          toastError(err);\r\n          setLoadingMore(false);\r\n        }\r\n      };\r\n\r\n      fetchMessages();\r\n    }, 500);\r\n    return () => {\r\n      clearTimeout(delayDebounceFn);\r\n    };\r\n  }, [pageNumber, ticketId, selectedQueuesMessage]);\r\n\r\n  useEffect(() => {\r\n    if (ticketId === \"undefined\") {\r\n      return;\r\n    }\r\n\r\n    const companyId = user.companyId;\r\n\r\n    //    const socket = socketManager.GetSocket();\r\n    const connectEventMessagesList = () => {\r\n      socket.emit(\"joinChatBox\", `${ticketId}`);\r\n    }\r\n\r\n    const onAppMessageMessagesList = (data) => {\r\n      if (data.action === \"create\" && data.ticket.uuid === ticketId) {\r\n        dispatch({ type: \"ADD_MESSAGE\", payload: data.message });\r\n        scrollToBottom();\r\n      }\r\n\r\n      if (data.action === \"update\" && data?.message?.ticket?.uuid === ticketId) {\r\n        dispatch({ type: \"UPDATE_MESSAGE\", payload: data.message });\r\n      }\r\n\r\n      if (data.action == \"delete\" && data.message.ticket?.uuid === ticketId) {\r\n        dispatch({ type: \"DELETE_MESSAGE\", payload: data.messageId });\r\n      }\r\n    }\r\n    socket.on(\"connect\", connectEventMessagesList);\r\n    socket.on(`company-${companyId}-appMessage`, onAppMessageMessagesList);\r\n\r\n    return () => {\r\n\r\n      socket.emit(\"joinChatBoxLeave\", `${ticketId}`)\r\n\r\n      socket.off(\"connect\", connectEventMessagesList);\r\n      socket.off(`company-${companyId}-appMessage`, onAppMessageMessagesList);\r\n    };\r\n\r\n  }, [ticketId]);\r\n\r\n  const loadMore = () => {\r\n    if (loadingMore) return;\r\n    setLoadingMore(true);\r\n    setPageNumber((prevPageNumber) => prevPageNumber + 1);\r\n  };\r\n\r\nconst scrollToBottom = () => {\r\n  setTimeout(() => {\r\n    if (lastMessageRef.current) {\r\n      lastMessageRef.current.scrollIntoView({});\r\n    }\r\n  }, 100);\r\n};\r\n\r\nconst handleScroll = (e) => {\r\n  if (!hasMore) return;\r\n  const { scrollTop } = e.currentTarget;\r\n\r\n  if (scrollTop === 0) {\r\n    document.getElementById(\"messagesList\").scrollTop = 1;\r\n  }\r\n\r\n  if (loading) {\r\n    return;\r\n  }\r\n\r\n  if (scrollTop < 50) {\r\n    loadMore();\r\n  }\r\n};\r\n\r\nconst handleOpenMessageOptionsMenu = (e, message) => {\r\n  setAnchorEl(e.currentTarget);\r\n  setSelectedMessage(message);\r\n};\r\n\r\nconst handleCloseMessageOptionsMenu = (e) => {\r\n  setAnchorEl(null);\r\n};\r\n\r\nconst hanldeReplyMessage = (e, message) => {\r\n  //if (ticket.status === \"open\" || ticket.status === \"group\") {\r\n  setAnchorEl(null);\r\n  setReplyingMessage(message);\r\n  //}\r\n};\r\n\r\nconst checkMessageMedia = (message) => {\r\n  if (message.mediaType === \"locationMessage\" && message.body.split('|').length >= 2) {\r\n    let locationParts = message.body.split('|')\r\n    let imageLocation = locationParts[0]\r\n    let linkLocation = locationParts[1]\r\n\r\n    let descriptionLocation = null\r\n\r\n    if (locationParts.length > 2)\r\n      descriptionLocation = message.body.split('|')[2]\r\n\r\n    return <LocationPreview image={imageLocation} link={linkLocation} description={descriptionLocation} />\r\n  } else\r\n\r\n    if (message.mediaType === \"contactMessage\") {\r\n      let array = message.body.split(\"\\n\");\r\n      let obj = [];\r\n      let contact = \"\";\r\n      for (let index = 0; index < array.length; index++) {\r\n        const v = array[index];\r\n        let values = v.split(\":\");\r\n        for (let ind = 0; ind < values.length; ind++) {\r\n          if (values[ind].indexOf(\"+\") !== -1) {\r\n            obj.push({ number: values[ind] });\r\n          }\r\n          if (values[ind].indexOf(\"FN\") !== -1) {\r\n            contact = values[ind + 1];\r\n          }\r\n        }\r\n      }\r\n      return <VcardPreview contact={contact} numbers={obj[0]?.number} queueId={message?.ticket?.queueId} whatsappId={message?.ticket?.whatsappId} />\r\n    } else\r\n\r\n      if (message.mediaType === \"image\") {\r\n        return <ModalImageCors imageUrl={message.mediaUrl} />;\r\n      } else\r\n\r\n        if (message.mediaType === \"audio\") {\r\n          return (\r\n            <AudioModal url={message.mediaUrl} />\r\n            // <audio controls>\r\n            //   <source src={message.mediaUrl} type=\"audio/ogg\"></source>\r\n            //   {/* <source src={message.mediaUrl} type=\"audio/mp3\"></source> */}\r\n            // </audio>\r\n          );\r\n        } else\r\n\r\n          if (message.mediaType === \"video\") {\r\n            return (\r\n              <video\r\n                className={classes.messageMedia}\r\n                src={message.mediaUrl}\r\n                controls\r\n              />\r\n            );\r\n          } else {\r\n            return (\r\n              <>\r\n                <div className={classes.downloadMedia}>\r\n                  <Button\r\n                    startIcon={<GetApp />}\r\n                    variant=\"outlined\"\r\n                    target=\"_blank\"\r\n                    href={message.mediaUrl}\r\n                  >\r\n                    Download\r\n                  </Button>\r\n                </div>\r\n                <Divider />\r\n              </>\r\n            );\r\n          }\r\n};\r\n\r\nconst renderMessageAck = (message) => {\r\n  if (message.ack === 0) {\r\n    return <AccessTime fontSize=\"small\" className={classes.ackIcons} />;\r\n  } else\r\n    if (message.ack === 1) {\r\n      return <Done fontSize=\"small\" className={classes.ackIcons} />;\r\n    } else\r\n      if (message.ack === 2) {\r\n        return <DoneAll fontSize=\"small\" className={classes.ackIcons} />;\r\n      } else\r\n        if (message.ack === 3 || message.ack === 4) {\r\n          return <DoneAll fontSize=\"small\" className={message.mediaType === \"audio\" ? classes.ackPlayedIcon : classes.ackDoneAllIcon} />;\r\n        } else\r\n          if (message.ack === 5) {\r\n            return <DoneAll fontSize=\"small\" className={classes.ackDoneAllIcon} />\r\n          }\r\n};\r\n\r\nconst renderDailyTimestamps = (message, index) => {\r\n  const today = format(new Date(), \"dd/MM/yyyy\")\r\n\r\n  if (index === 0) {\r\n    return (\r\n      <span\r\n        className={classes.dailyTimestamp}\r\n        key={`timestamp-${message.id}`}\r\n      >\r\n        <div className={classes.dailyTimestampText}>\r\n          {today === format(parseISO(messagesList[index].createdAt), \"dd/MM/yyyy\") ? \"HOJE\" : format(parseISO(messagesList[index].createdAt), \"dd/MM/yyyy\")}\r\n        </div>\r\n      </span>\r\n    );\r\n  } else\r\n    if (index < messagesList.length - 1) {\r\n      let messageDay = parseISO(messagesList[index].createdAt);\r\n      let previousMessageDay = parseISO(messagesList[index - 1].createdAt);\r\n\r\n      if (!isSameDay(messageDay, previousMessageDay)) {\r\n        return (\r\n          <span\r\n            className={classes.dailyTimestamp}\r\n            key={`timestamp-${message.id}`}\r\n          >\r\n            <div className={classes.dailyTimestampText}>\r\n              {today === format(parseISO(messagesList[index].createdAt), \"dd/MM/yyyy\") ? \"HOJE\" : format(parseISO(messagesList[index].createdAt), \"dd/MM/yyyy\")}\r\n            </div>\r\n          </span>\r\n        );\r\n      }\r\n    } else\r\n      if (index === messagesList.length - 1) {\r\n        return (\r\n          <div\r\n            key={`ref-${message.id}`}\r\n            ref={lastMessageRef}\r\n            style={{ float: \"left\", clear: \"both\" }}\r\n          />\r\n        );\r\n      }\r\n};\r\n\r\n\r\nconst renderTicketsSeparator = (message, index) => {\r\n  let lastTicket = messagesList[index - 1]?.ticketId;\r\n  let currentTicket = message.ticketId;\r\n\r\n  if (lastTicket !== currentTicket && lastTicket !== undefined) {\r\n    if (message?.ticket?.queue) {\r\n      return (\r\n        <span\r\n          className={classes.currentTick}\r\n          key={`timestamp-${message.id}a`}\r\n        >\r\n          <div\r\n            className={classes.currentTicktText}\r\n            style={{ backgroundColor: message?.ticket?.queue?.color || \"grey\" }}\r\n          >\r\n            #{i18n.t(\"ticketsList.called\")} {message?.ticketId} - {message?.ticket?.queue?.name}\r\n          </div>\r\n\r\n        </span>\r\n      );\r\n    } else {\r\n      return (\r\n        <span\r\n          className={classes.currentTick}\r\n          key={`timestamp-${message.id}b`}\r\n        >\r\n          <div\r\n            className={classes.currentTicktText}\r\n            style={{ backgroundColor: \"grey\" }}\r\n          >\r\n            #{i18n.t(\"ticketsList.called\")} {message.ticketId} - {i18n.t(\"ticketsList.noQueue\")}\r\n          </div>\r\n\r\n        </span>\r\n      );\r\n    }\r\n  }\r\n\r\n};\r\n\r\nconst renderMessageDivider = (message, index) => {\r\n  if (index < messagesList.length && index > 0) {\r\n    let messageUser = messagesList[index].fromMe;\r\n    let previousMessageUser = messagesList[index - 1].fromMe;\r\n    if (messageUser !== previousMessageUser) {\r\n      return (\r\n\r\n        <span style={{ marginTop: 16 }} key={`divider-${message.id}`}></span>\r\n      );\r\n    }\r\n  }\r\n};\r\n\r\nconst path = require('path');\r\n\r\nconst renderQuotedMessage = (message) => {\r\n\r\n  return (\r\n    <div\r\n      className={clsx(classes.quotedContainerLeft, {\r\n        [classes.quotedContainerRight]: message.fromMe,\r\n      })}\r\n    >\r\n      <span\r\n        className={clsx(classes.quotedSideColorLeft, {\r\n          [classes.quotedSideColorRight]: message.quotedMsg?.fromMe,\r\n        })}\r\n      ></span>\r\n      <div className={classes.quotedMsg}>\r\n        {!message.quotedMsg?.fromMe && (\r\n          <span className={classes.messageContactName}>\r\n            {message.quotedMsg?.contact?.name}\r\n          </span>\r\n        )}\r\n\r\n        {message.quotedMsg.mediaType === \"audio\"\r\n          && (\r\n            <div className={classes.downloadMedia}>\r\n              <AudioModal url={message.quotedMsg.mediaUrl} />\r\n\r\n              {/* <audio controls>\r\n                  <source src={message.quotedMsg.mediaUrl} type=\"audio/mp3\"></source>\r\n                  {/* <source src={message.quotedMsg.mediaUrl} type=\"audio/ogg\"></source> \r\n                </audio> */}\r\n            </div>\r\n          )\r\n        }\r\n        {message.quotedMsg.mediaType === \"video\"\r\n          && (\r\n            <video\r\n              className={classes.messageMedia}\r\n              src={message.quotedMsg.mediaUrl}\r\n              controls\r\n            />\r\n          )\r\n        }\r\n        {message.quotedMsg.mediaType === \"contactMessage\"\r\n          && (\r\n            \"Contato\"\r\n          )\r\n        }\r\n        {message.quotedMsg.mediaType === \"application\"\r\n          && (\r\n            <div className={classes.downloadMedia}>\r\n              <Button\r\n                startIcon={<GetApp />}\r\n                // color=\"primary\"\r\n                variant=\"outlined\"\r\n                target=\"_blank\"\r\n                href={message.quotedMsg.mediaUrl}\r\n              >\r\n                Download\r\n              </Button>\r\n            </div>\r\n          )\r\n        }\r\n\r\n        {message.quotedMsg.mediaType === \"image\"\r\n          && (\r\n            <ModalImageCors imageUrl={message.quotedMsg.mediaUrl} />)\r\n          || message.quotedMsg?.body}\r\n\r\n        {!message.quotedMsg.mediaType === \"image\" && message.quotedMsg?.body}\r\n\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst handleDrag = event => {\r\n  event.preventDefault();\r\n  event.stopPropagation();\r\n  if (event.type === \"dragenter\" || event.type === \"dragover\") {\r\n    setDragActive(true);\r\n  } else if (event.type === \"dragleave\") {\r\n    setDragActive(false);\r\n  }\r\n}\r\n\r\nconst isYouTubeLink = (url) => {\r\n  const youtubeRegex = /(?:youtube\\.com\\/(?:[^\\/\\n\\s]+\\/\\S+\\/|(?:v|e(?:mbed)?)\\/|\\S*?[?&]v=)|youtu\\.be\\/)([a-zA-Z0-9_-]{11})/;\r\n  return youtubeRegex.test(url);\r\n};\r\n\r\nconst handleDrop = event => {\r\n  event.preventDefault();\r\n  event.stopPropagation();\r\n  setDragActive(false);\r\n  if (event.dataTransfer.files && event.dataTransfer.files[0]) {\r\n    if (onDrop) {\r\n      onDrop(event.dataTransfer.files);\r\n    }\r\n  }\r\n}\r\nconst xmlRegex = /<([^>]+)>/g;\r\nconst boldRegex = /\\*(.*?)\\*/g;\r\n\r\nconst formatXml = (xmlString) => {\r\n  // Verifica se o XML contÃ©m a assinatura com nome do atendente\r\n  if (boldRegex.test(xmlString)) {\r\n    // Formata o texto dentro da assinatura em negrito\r\n    xmlString = xmlString.replace(boldRegex, \"**$1**\");\r\n  }\r\n  return xmlString;\r\n};\r\n\r\nconst renderMessages = () => {\r\n\r\n  if (messagesList.length > 0) {\r\n    const viewMessagesList = messagesList.map((message, index) => {\r\n      if (message.mediaType === \"call_log\") {\r\n        return (\r\n          <React.Fragment key={message.id}>\r\n            {renderDailyTimestamps(message, index)}\r\n            {renderTicketsSeparator(message, index)}\r\n            {renderMessageDivider(message, index)}\r\n            <div className={classes.messageCenter}>\r\n              <IconButton\r\n                variant=\"contained\"\r\n                size=\"small\"\r\n                id=\"messageActionsButton\"\r\n                disabled={message.isDeleted}\r\n                className={classes.messageActionsButton}\r\n                onClick={(e) => handleOpenMessageOptionsMenu(e, message)}\r\n              >\r\n                <ExpandMore />\r\n              </IconButton>\r\n              {isGroup && (\r\n                <span className={classes.messageContactName}>\r\n                  {message.contact?.name}\r\n                </span>\r\n              )}\r\n\r\n              {/* {isGroup && (\r\n                  <span className={classes.messageContactName}>\r\n                    {JSON.parse(message.dataJson).pushName} #{message.contact?.name}\r\n                  </span>\r\n                )} */}\r\n              <div>\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 17\" width=\"20\" height=\"17\">\r\n                  <path fill=\"#df3333\" d=\"M18.2 12.1c-1.5-1.8-5-2.7-8.2-2.7s-6.7 1-8.2 2.7c-.7.8-.3 2.3.2 2.8.2.2.3.3.5.3 1.4 0 3.6-.7 3.6-.7.5-.2.8-.5.8-1v-1.3c.7-1.2 5.4-1.2 6.4-.1l.1.1v1.3c0 .2.1.4.2.6.1.2.3.3.5.4 0 0 2.2.7 3.6.7.2 0 1.4-2 .5-3.1zM5.4 3.2l4.7 4.6 5.8-5.7-.9-.8L10.1 6 6.4 2.3h2.5V1H4.1v4.8h1.3V3.2z\"></path>\r\n                </svg> <span>{i18n.t(\"ticketsList.missedCall\")} {format(parseISO(message.createdAt), \"HH:mm\")}</span>\r\n              </div>\r\n            </div>\r\n          </React.Fragment>\r\n        );\r\n      }\r\n\r\n      if (!message.fromMe) {\r\n        return (\r\n          <React.Fragment key={message.id}>\r\n            {renderDailyTimestamps(message, index)}\r\n            {renderTicketsSeparator(message, index)}\r\n            {renderMessageDivider(message, index)}\r\n            <div\r\n              className={classes.messageLeft}\r\n              title={message.queueId && message.queue?.name}\r\n              onDoubleClick={(e) => hanldeReplyMessage(e, message)}\r\n            >\r\n              {showSelectMessageCheckbox && (\r\n                <SelectMessageCheckbox\r\n                  // showSelectMessageCheckbox={showSelectMessageCheckbox}\r\n                  message={message}\r\n                // selectedMessagesList={selectedMessagesList}\r\n                // setSelectedMessagesList={setSelectedMessagesList}\r\n                />\r\n              )}\r\n              <IconButton\r\n                variant=\"contained\"\r\n                size=\"small\"\r\n                id=\"messageActionsButton\"\r\n                disabled={message.isDeleted}\r\n                className={classes.messageActionsButton}\r\n                onClick={(e) => handleOpenMessageOptionsMenu(e, message)}\r\n              >\r\n                <ExpandMore />\r\n              </IconButton>\r\n\r\n              {message.isForwarded && (\r\n                <div>\r\n                  <span className={classes.forwardMessage}\r\n                  ><Reply style={{ color: \"grey\", transform: 'scaleX(-1)' }} /> Encaminhada\r\n                  </span>\r\n                  <br />\r\n                </div>\r\n              )}\r\n              {isGroup && (\r\n                <span className={classes.messageContactName}>\r\n                  {message.contact?.name}\r\n                </span>\r\n              )}\r\n              {isYouTubeLink(message.body) && (\r\n                <>\r\n                  <YouTubePreview videoUrl={message.body} />\r\n                </>\r\n              )}\r\n              {/* {isGroup && (\r\n                  <span className={classes.messageContactName}>\r\n                    {JSON.parse(message.dataJson).pushName} #{message.contact?.name}\r\n                  </span>\r\n                )} */}\r\n\r\n              {/* aviso de mensagem apagado pelo contato */}\r\n\r\n              {!lgpdDeleteMessage && message.isDeleted && (\r\n                <div>\r\n                  <span className={classes.deletedMessage}\r\n                  >ðŸš« Essa mensagem foi apagada pelo contato &nbsp;\r\n                  </span>\r\n                </div>\r\n              )}\r\n\r\n              {(message.mediaUrl || message.mediaType === \"locationMessage\" || message.mediaType === \"contactMessage\"\r\n                //|| message.mediaType === \"multi_vcard\" \r\n              ) && checkMessageMedia(message)}\r\n\r\n              <div className={clsx(classes.textContentItem, {\r\n                [classes.textContentItemDeleted]: message.isDeleted,\r\n              })}>\r\n                {message.quotedMsg && renderQuotedMessage(message)}\r\n                {\r\n                  (\r\n                    (message.mediaUrl !== null && (message.mediaType === \"image\" || message.mediaType === \"video\") && path.basename(message.mediaUrl).trim() !== message.body.trim()) ||\r\n                    message.mediaType !== \"audio\" &&\r\n                    message.mediaType !== \"image\" &&\r\n                    message.mediaType !== \"video\" &&\r\n                    message.mediaType != \"reactionMessage\" &&\r\n                    message.mediaType != \"locationMessage\" && message.mediaType !== \"contactMessage\") && (\r\n                    <>\r\n                      {xmlRegex.test(message.body) && (\r\n                        <span>{message.body}</span>\r\n\r\n                      )}\r\n                      {!xmlRegex.test(message.body) && (\r\n                        <MarkdownWrapper>{(lgpdDeleteMessage && message.isDeleted) ? \"ðŸš« _Mensagem apagada_ \" :\r\n                          message.body\r\n                        }</MarkdownWrapper>)}\r\n\r\n                    </>\r\n\r\n                  )}\r\n\r\n                {message.quotedMsg && message.mediaType === \"reactionMessage\" && (\r\n                  <>\r\n                    <span style={{ marginLeft: \"0px\" }}>\r\n                      <MarkdownWrapper>\r\n                        {\"\" + message?.contact?.name + \" reagiu... \" + message.body}\r\n                      </MarkdownWrapper>\r\n                    </span>\r\n                  </>\r\n                )}\r\n\r\n                <span className={classes.timestamp}>\r\n                  {message.isEdited ? \"Editada \" + format(parseISO(message.createdAt), \"HH:mm\") : format(parseISO(message.createdAt), \"HH:mm\")}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </React.Fragment>\r\n        );\r\n      } else {\r\n        return (\r\n          <React.Fragment key={message.id}>\r\n            {renderDailyTimestamps(message, index)}\r\n            {renderTicketsSeparator(message, index)}\r\n            {renderMessageDivider(message, index)}\r\n            <div\r\n              className={message.isPrivate ? classes.messageRightPrivate : classes.messageRight}\r\n              title={message.queueId && message.queue?.name}\r\n              onDoubleClick={(e) => hanldeReplyMessage(e, message)}\r\n            >\r\n              {showSelectMessageCheckbox && (\r\n                <SelectMessageCheckbox\r\n                  // showSelectMessageCheckbox={showSelectMessageCheckbox}\r\n                  message={message}\r\n                // selectedMessagesList={selectedMessagesList}\r\n                // setSelectedMessagesList={setSelectedMessagesList}\r\n                />\r\n              )}\r\n\r\n              <IconButton\r\n                variant=\"contained\"\r\n                size=\"small\"\r\n                id=\"messageActionsButton\"\r\n                disabled={message.isDeleted}\r\n                className={classes.messageActionsButton}\r\n                onClick={(e) => handleOpenMessageOptionsMenu(e, message)}\r\n              >\r\n                <ExpandMore />\r\n              </IconButton>\r\n              {message.isForwarded && (\r\n                <div>\r\n                  <span className={classes.forwardMessage}\r\n                  ><Reply style={{ color: \"grey\", transform: 'scaleX(-1)' }} /> Encaminhada\r\n                  </span>\r\n                  <br />\r\n                </div>\r\n              )}\r\n              {isYouTubeLink(message.body) && (\r\n                <>\r\n                  <YouTubePreview videoUrl={message.body} />\r\n                </>\r\n              )}\r\n              {!lgpdDeleteMessage && message.isDeleted && (\r\n                <div>\r\n                  <span className={classes.deletedMessage}\r\n                  >ðŸš« Essa mensagem foi apagada &nbsp;\r\n                  </span>\r\n                </div>\r\n              )}\r\n              {(message.mediaUrl || message.mediaType === \"locationMessage\" || message.mediaType === \"contactMessage\"\r\n                //|| message.mediaType === \"multi_vcard\" \r\n              ) && checkMessageMedia(message)}\r\n              <div\r\n                className={clsx(classes.textContentItem, {\r\n                  [classes.textContentItemDeleted]: message.isDeleted,\r\n                })}\r\n              >\r\n\r\n                {/* {message.isDeleted && (`ðŸš«`)} */}\r\n\r\n\r\n\r\n                {message.quotedMsg && renderQuotedMessage(message)}\r\n\r\n                {\r\n                  ((message.mediaType === \"image\" || message.mediaType === \"video\") && path.basename(message.mediaUrl) === message.body) ||\r\n                  (message.mediaType !== \"audio\" && message.mediaType != \"reactionMessage\" && message.mediaType != \"locationMessage\" && message.mediaType !== \"contactMessage\") && (\r\n                    <>\r\n                      {xmlRegex.test(message.body) && (\r\n                        <div>{formatXml(message.body)}</div>\r\n\r\n                      )}\r\n                      {!xmlRegex.test(message.body) && (<MarkdownWrapper>{message.body}</MarkdownWrapper>)}\r\n\r\n                    </>\r\n                  )}\r\n\r\n                {message.quotedMsg && message.mediaType === \"reactionMessage\" && (\r\n                  <>\r\n                    <span style={{ marginLeft: \"0px\" }}>\r\n                      <MarkdownWrapper>\r\n                        {\"VocÃª reagiu... \" + message.body}\r\n                      </MarkdownWrapper>\r\n                    </span>\r\n                  </>\r\n                )}\r\n\r\n                <span className={classes.timestamp}>\r\n                  {message.isEdited ? \"Editada \" + format(parseISO(message.createdAt), \"HH:mm\") : format(parseISO(message.createdAt), \"HH:mm\")}\r\n                  {renderMessageAck(message)}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </React.Fragment>\r\n        );\r\n      }\r\n    });\r\n    return viewMessagesList;\r\n  } else {\r\n    return <div>Diga olÃ¡ para seu novo contato!</div>;\r\n  }\r\n};\r\n\r\nreturn (\r\n  <div className={classes.messagesListWrapper} onDragEnter={handleDrag}>\r\n    {dragActive && <div className={classes.dragElement} onDragEnter={handleDrag} onDragLeave={handleDrag} onDragOver={handleDrag} onDrop={handleDrop}>Solte o arquivo aqui</div>}\r\n\r\n    <MessageOptionsMenu\r\n      message={selectedMessage}\r\n      anchorEl={anchorEl}\r\n      menuOpen={messageOptionsMenuOpen}\r\n      handleClose={handleCloseMessageOptionsMenu}\r\n      isGroup={isGroup}\r\n      whatsappId={whatsappId}\r\n      queueId={queueId}\r\n    />\r\n    <div\r\n      id=\"messagesList\"\r\n      className={classes.messagesList}\r\n      onScroll={handleScroll}\r\n    >\r\n      {messagesList.length > 0 ?\r\n        renderMessages()\r\n        : []}\r\n    </div>\r\n\r\n    {(channel !== \"whatsapp\" && channel !== undefined) && (\r\n      <div\r\n        style={{\r\n          width: \"100%\",\r\n          display: \"flex\",\r\n          padding: \"10px\",\r\n          alignItems: \"center\",\r\n          backgroundColor: \"#E1F3FB\",\r\n        }}\r\n      >\r\n        {channel === \"facebook\" ? (\r\n          <Facebook />\r\n        ) : (\r\n          <Instagram />\r\n        )}\r\n\r\n        <span>\r\n          VocÃª tem 24h para responder apÃ³s receber uma mensagem, de acordo\r\n          com as polÃ­ticas do Facebook.\r\n        </span>\r\n      </div>\r\n    )}\r\n    {loading && (\r\n      <div>\r\n        <CircularProgress className={classes.circleLoading} />\r\n      </div>\r\n    )}\r\n  </div>\r\n);\r\n};\r\n\r\nexport default MessagesList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}