{"ast":null,"code":"import React,{useState,useEffect,useRef}from\"react\";import*as Yup from\"yup\";import{Formik,FieldArray,Form,Field}from\"formik\";import{toast}from\"react-toastify\";import Select from'@material-ui/core/Select';import InputLabel from'@material-ui/core/InputLabel';import MenuItem from'@material-ui/core/MenuItem';import{makeStyles}from\"@material-ui/core/styles\";import{green}from\"@material-ui/core/colors\";import Button from\"@material-ui/core/Button\";import TextField from\"@material-ui/core/TextField\";import Dialog from\"@material-ui/core/Dialog\";import DialogActions from\"@material-ui/core/DialogActions\";import DialogContent from\"@material-ui/core/DialogContent\";import DialogTitle from\"@material-ui/core/DialogTitle\";import Typography from\"@material-ui/core/Typography\";import IconButton from\"@material-ui/core/IconButton\";import DeleteOutlineIcon from\"@material-ui/icons/DeleteOutline\";import CircularProgress from\"@material-ui/core/CircularProgress\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import toastError from\"../../errors/toastError\";import{Stack}from\"@mui/material\";const useStyles=makeStyles(theme=>({root:{display:\"flex\",flexWrap:\"wrap\"},textField:{marginRight:theme.spacing(1),flex:1},extraAttr:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\"},btnWrapper:{position:\"relative\"},buttonProgress:{color:green[500],position:\"absolute\",top:\"50%\",left:\"50%\",marginTop:-12,marginLeft:-12}}));const FlowBuilderTicketModal=_ref=>{let{open,onSave,data,onUpdate,close}=_ref;const classes=useStyles();const isMounted=useRef(true);const[activeModal,setActiveModal]=useState(false);const[queues,setQueues]=useState([]);const[selectedQueue,setQueueSelected]=useState();useEffect(()=>{if(open==='edit'){(async()=>{try{const{data:old}=await api.get(\"/queue\");setQueues(old);const queue=old.find(item=>item.id===data.data.id);if(queue){setQueueSelected(queue.id);}setActiveModal(true);}catch(error){console.log(error);}})();}else if(open==='create'){(async()=>{try{const{data}=await api.get(\"/queue\");setQueues(data);setActiveModal(true);}catch(error){console.log(error);}})();}return()=>{isMounted.current=false;};},[open]);const handleClose=()=>{close(null);setActiveModal(false);};const handleSaveContact=()=>{if(!selectedQueue){return toast.error('Adicione uma fila');}if(open==='edit'){const queue=queues.find(item=>item.id===selectedQueue);onUpdate({...data,data:queue});}else if(open==='create'){const queue=queues.find(item=>item.id===selectedQueue);onSave({data:queue});}handleClose();};return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Dialog,{open:activeModal,onClose:handleClose,fullWidth:\"md\",scroll:\"paper\"},/*#__PURE__*/React.createElement(DialogTitle,{id:\"form-dialog-title\"},open==='create'?\"Adicionar um ticket ao fluxo\":\"Editar Ticket\"),/*#__PURE__*/React.createElement(Stack,null,/*#__PURE__*/React.createElement(DialogContent,{dividers:true},/*#__PURE__*/React.createElement(Select,{labelId:\"demo-simple-select-label\",id:\"demo-simple-select\",value:selectedQueue,style:{width:\"95%\"},onChange:e=>{setQueueSelected(e.target.value);},MenuProps:{anchorOrigin:{vertical:\"bottom\",horizontal:\"left\"},transformOrigin:{vertical:\"top\",horizontal:\"left\"},getContentAnchorEl:null},renderValue:()=>{if(selectedQueue===\"\"){return\"Selecione uma Conexão\";}const queue=queues.find(w=>w.id===selectedQueue);return queue.name;}},queues.length>0&&queues.map((queue,index)=>/*#__PURE__*/React.createElement(MenuItem,{dense:true,key:index,value:queue.id},queue.name)))),/*#__PURE__*/React.createElement(DialogActions,null,/*#__PURE__*/React.createElement(Button,{onClick:handleClose,color:\"secondary\",variant:\"outlined\"},i18n.t(\"contactModal.buttons.cancel\")),/*#__PURE__*/React.createElement(Button,{type:\"submit\",color:\"primary\",variant:\"contained\",className:classes.btnWrapper,onClick:handleSaveContact},open==='create'?\"Adicionar\":'Editar')))));};export default FlowBuilderTicketModal;","map":{"version":3,"names":["React","useState","useEffect","useRef","Yup","Formik","FieldArray","Form","Field","toast","Select","InputLabel","MenuItem","makeStyles","green","Button","TextField","Dialog","DialogActions","DialogContent","DialogTitle","Typography","IconButton","DeleteOutlineIcon","CircularProgress","i18n","api","toastError","Stack","useStyles","theme","root","display","flexWrap","textField","marginRight","spacing","flex","extraAttr","justifyContent","alignItems","btnWrapper","position","buttonProgress","color","top","left","marginTop","marginLeft","FlowBuilderTicketModal","_ref","open","onSave","data","onUpdate","close","classes","isMounted","activeModal","setActiveModal","queues","setQueues","selectedQueue","setQueueSelected","old","get","queue","find","item","id","error","console","log","current","handleClose","handleSaveContact","createElement","className","onClose","fullWidth","scroll","dividers","labelId","value","style","width","onChange","e","target","MenuProps","anchorOrigin","vertical","horizontal","transformOrigin","getContentAnchorEl","renderValue","w","name","length","map","index","dense","key","onClick","variant","t","type"],"sources":["C:/ProjectsCode/ZapRun/ZapRun/frontend/src/components/FlowBuilderAddTicketModal/index.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\n\r\nimport * as Yup from \"yup\";\r\nimport { Formik, FieldArray, Form, Field } from \"formik\";\r\nimport { toast } from \"react-toastify\";\r\nimport Select from '@material-ui/core/Select';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { green } from \"@material-ui/core/colors\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport DeleteOutlineIcon from \"@material-ui/icons/DeleteOutline\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport { i18n } from \"../../translate/i18n\";\r\nimport api from \"../../services/api\";\r\nimport toastError from \"../../errors/toastError\";\r\nimport { Stack } from \"@mui/material\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        display: \"flex\",\r\n        flexWrap: \"wrap\"\r\n    },\r\n    textField: {\r\n        marginRight: theme.spacing(1),\r\n        flex: 1\r\n    },\r\n\r\n    extraAttr: {\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\"\r\n    },\r\n\r\n    btnWrapper: {\r\n        position: \"relative\"\r\n    },\r\n\r\n    buttonProgress: {\r\n        color: green[500],\r\n        position: \"absolute\",\r\n        top: \"50%\",\r\n        left: \"50%\",\r\n        marginTop: -12,\r\n        marginLeft: -12\r\n    }\r\n}));\r\n\r\nconst FlowBuilderTicketModal = ({\r\n    open,\r\n    onSave,\r\n    data,\r\n    onUpdate,\r\n    close\r\n}) => {\r\n    const classes = useStyles();\r\n    const isMounted = useRef(true);\r\n    const [activeModal, setActiveModal] = useState(false)\r\n    const [queues, setQueues] = useState([])\r\n    const [selectedQueue, setQueueSelected] = useState()\r\n\r\n    useEffect(() => {\r\n        if (open === 'edit') {\r\n            (async () => {\r\n                try {\r\n                    const { data: old } = await api.get(\"/queue\");\r\n                    setQueues(old)\r\n                    const queue = old.find((item) => item.id === data.data.id)\r\n                    if (queue) {\r\n                        setQueueSelected(queue.id)\r\n                    }\r\n                    setActiveModal(true)\r\n                } catch (error) {\r\n                    console.log(error)\r\n                }\r\n            })();\r\n\r\n        } else if (open === 'create') {\r\n            (async () => {\r\n                try {\r\n                    const { data } = await api.get(\"/queue\");\r\n                    setQueues(data)\r\n                    setActiveModal(true)\r\n                } catch (error) {\r\n                    console.log(error)\r\n                }\r\n            })()\r\n        }\r\n        return () => {\r\n            isMounted.current = false;\r\n        };\r\n    }, [open]);\r\n\r\n\r\n    const handleClose = () => {\r\n        close(null)\r\n        setActiveModal(false)\r\n    };\r\n\r\n    const handleSaveContact = () => {\r\n        if (!selectedQueue) {\r\n            return toast.error('Adicione uma fila')\r\n        }\r\n        if (open === 'edit') {\r\n            const queue = queues.find(item => item.id === selectedQueue)\r\n            onUpdate({\r\n                ...data,\r\n                data: queue\r\n            });\r\n        } else if (open === 'create') {\r\n            const queue = queues.find(item => item.id === selectedQueue)\r\n            onSave({\r\n                data: queue\r\n            })\r\n        }\r\n        handleClose()\r\n\r\n    };\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <Dialog open={activeModal} onClose={handleClose} fullWidth=\"md\" scroll=\"paper\">\r\n                <DialogTitle id=\"form-dialog-title\">\r\n                    {open === 'create' ? `Adicionar um ticket ao fluxo` : `Editar Ticket`}\r\n                </DialogTitle>\r\n                <Stack>\r\n                    <DialogContent dividers>\r\n                        <Select\r\n                            labelId=\"demo-simple-select-label\"\r\n                            id=\"demo-simple-select\"\r\n                            value={selectedQueue}\r\n                            style={{ width: \"95%\" }}\r\n                            onChange={(e) => { setQueueSelected(e.target.value) }}\r\n                            MenuProps={{\r\n                                anchorOrigin: {\r\n                                    vertical: \"bottom\",\r\n                                    horizontal: \"left\",\r\n                                },\r\n                                transformOrigin: {\r\n                                    vertical: \"top\",\r\n                                    horizontal: \"left\",\r\n                                },\r\n                                getContentAnchorEl: null,\r\n                            }}\r\n                            renderValue={() => {\r\n                                if (selectedQueue === \"\") {\r\n                                    return \"Selecione uma Conexão\"\r\n                                }\r\n                                const queue = queues.find(w => w.id === selectedQueue)\r\n                                return queue.name\r\n                            }}\r\n                        >\r\n\r\n                            {queues.length > 0 && (\r\n                                queues.map((queue, index) => (\r\n                                    <MenuItem dense key={index} value={queue.id}>{queue.name}</MenuItem>\r\n                                ))\r\n                            )}\r\n                        </Select>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button\r\n                            onClick={handleClose}\r\n                            color=\"secondary\"\r\n                            variant=\"outlined\"\r\n                        >\r\n                            {i18n.t(\"contactModal.buttons.cancel\")}\r\n                        </Button>\r\n                        <Button\r\n                            type=\"submit\"\r\n                            color=\"primary\"\r\n                            variant=\"contained\"\r\n                            className={classes.btnWrapper}\r\n                            onClick={handleSaveContact}\r\n                        >\r\n                            {open === 'create' ? `Adicionar` : 'Editar'}\r\n                        </Button>\r\n                    </DialogActions>\r\n                </Stack>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default FlowBuilderTicketModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}