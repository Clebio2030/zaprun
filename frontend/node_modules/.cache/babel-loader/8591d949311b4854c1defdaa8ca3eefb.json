{"ast":null,"code":"import React,{useContext,useState}from\"react\";import{Chip,IconButton,List,ListItem,ListItemSecondaryAction,ListItemText,makeStyles}from\"@material-ui/core\";import{useHistory,useParams}from\"react-router-dom\";import{AuthContext}from\"../../context/Auth/AuthContext\";import{useDate}from\"../../hooks/useDate\";import DeleteIcon from\"@material-ui/icons/Delete\";import EditIcon from\"@material-ui/icons/Edit\";import ConfirmationModal from\"../../components/ConfirmationModal\";import api from\"../../services/api\";const useStyles=makeStyles(theme=>({mainContainer:{display:\"flex\",flexDirection:\"column\",position:\"relative\",flex:1,height:\"calc(100% - 58px)\",overflow:\"hidden\",borderRadius:0,backgroundColor:theme.palette.boxlist//DARK MODE ZAPRUN DESIGN//\n},chatList:{display:\"flex\",flexDirection:\"column\",position:\"relative\",flex:1,overflowY:\"scroll\",...theme.scrollbarStyles},listItem:{cursor:\"pointer\"}}));export default function ChatList(_ref){let{chats,handleSelectChat,handleDeleteChat,handleEditChat,pageInfo,loading}=_ref;const classes=useStyles();const history=useHistory();const{user}=useContext(AuthContext);const{datetimeToClient}=useDate();const[confirmationModal,setConfirmModalOpen]=useState(false);const[selectedChat,setSelectedChat]=useState({});const{id}=useParams();const goToMessages=async chat=>{if(unreadMessages(chat)>0){try{await api.post(\"/chats/\".concat(chat.id,\"/read\"),{userId:user.id});}catch(err){}}if(id!==chat.uuid){history.push(\"/chats/\".concat(chat.uuid));handleSelectChat(chat);}};const handleDelete=()=>{handleDeleteChat(selectedChat);};const unreadMessages=chat=>{const currentUser=chat.users.find(u=>u.userId===user.id);return currentUser.unreads;};const getPrimaryText=chat=>{const mainText=chat.title;const unreads=unreadMessages(chat);return/*#__PURE__*/React.createElement(React.Fragment,null,mainText,unreads>0&&/*#__PURE__*/React.createElement(Chip,{size:\"small\",style:{marginLeft:5},label:unreads,color:\"secondary\"}));};const getSecondaryText=chat=>{return chat.lastMessage!==\"\"?\"\".concat(datetimeToClient(chat.updatedAt),\": \").concat(chat.lastMessage):\"\";};const getItemStyle=chat=>{return{borderLeft:chat.uuid===id?\"6px solid #b8b8b8\":null,backgroundColor:chat.uuid===id?\"theme.palette.chatlist\":null};};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ConfirmationModal,{title:\"Excluir Conversa\",open:confirmationModal,onClose:setConfirmModalOpen,onConfirm:handleDelete},\"Esta a\\xE7\\xE3o n\\xE3o pode ser revertida, confirmar?\"),/*#__PURE__*/React.createElement(\"div\",{className:classes.mainContainer},/*#__PURE__*/React.createElement(\"div\",{className:classes.chatList},/*#__PURE__*/React.createElement(List,null,Array.isArray(chats)&&chats.length>0&&chats.map((chat,key)=>/*#__PURE__*/React.createElement(ListItem,{onClick:()=>goToMessages(chat),key:key,className:classes.listItem,style:getItemStyle(chat),button:true},/*#__PURE__*/React.createElement(ListItemText,{primary:getPrimaryText(chat),secondary:getSecondaryText(chat)}),chat.ownerId===user.id&&/*#__PURE__*/React.createElement(ListItemSecondaryAction,null,/*#__PURE__*/React.createElement(IconButton,{onClick:()=>{goToMessages(chat).then(()=>{handleEditChat(chat);});},edge:\"end\",\"aria-label\":\"delete\",size:\"small\",style:{marginRight:5}},/*#__PURE__*/React.createElement(EditIcon,null)),/*#__PURE__*/React.createElement(IconButton,{onClick:()=>{setSelectedChat(chat);setConfirmModalOpen(true);},edge:\"end\",\"aria-label\":\"delete\",size:\"small\"},/*#__PURE__*/React.createElement(DeleteIcon,null)))))))));}","map":{"version":3,"names":["React","useContext","useState","Chip","IconButton","List","ListItem","ListItemSecondaryAction","ListItemText","makeStyles","useHistory","useParams","AuthContext","useDate","DeleteIcon","EditIcon","ConfirmationModal","api","useStyles","theme","mainContainer","display","flexDirection","position","flex","height","overflow","borderRadius","backgroundColor","palette","boxlist","chatList","overflowY","scrollbarStyles","listItem","cursor","ChatList","_ref","chats","handleSelectChat","handleDeleteChat","handleEditChat","pageInfo","loading","classes","history","user","datetimeToClient","confirmationModal","setConfirmModalOpen","selectedChat","setSelectedChat","id","goToMessages","chat","unreadMessages","post","concat","userId","err","uuid","push","handleDelete","currentUser","users","find","u","unreads","getPrimaryText","mainText","title","createElement","Fragment","size","style","marginLeft","label","color","getSecondaryText","lastMessage","updatedAt","getItemStyle","borderLeft","open","onClose","onConfirm","className","Array","isArray","length","map","key","onClick","button","primary","secondary","ownerId","then","edge","marginRight"],"sources":["C:/ProjectsCode/ZapRun/ZapRun/frontend/src/pages/Chat/ChatList.js"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport {\n  Chip,\n  IconButton,\n  List,\n  ListItem,\n  ListItemSecondaryAction,\n  ListItemText,\n  makeStyles,\n} from \"@material-ui/core\";\n\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport { useDate } from \"../../hooks/useDate\";\n\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport EditIcon from \"@material-ui/icons/Edit\";\n\nimport ConfirmationModal from \"../../components/ConfirmationModal\";\nimport api from \"../../services/api\";\n\nconst useStyles = makeStyles((theme) => ({\n  mainContainer: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    position: \"relative\",\n    flex: 1,\n    height: \"calc(100% - 58px)\",\n    overflow: \"hidden\",\n    borderRadius: 0,\n    backgroundColor: theme.palette.boxlist, //DARK MODE ZAPRUN DESIGN//\n  },\n  chatList: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    position: \"relative\",\n    flex: 1,\n    overflowY: \"scroll\",\n    ...theme.scrollbarStyles,\n  },\n  listItem: {\n    cursor: \"pointer\",\n  },\n}));\n\nexport default function ChatList({\n  chats,\n  handleSelectChat,\n  handleDeleteChat,\n  handleEditChat,\n  pageInfo,\n  loading,\n}) {\n  const classes = useStyles();\n  const history = useHistory();\n  const { user } = useContext(AuthContext);\n  const { datetimeToClient } = useDate();\n\n  const [confirmationModal, setConfirmModalOpen] = useState(false);\n  const [selectedChat, setSelectedChat] = useState({});\n\n  const { id } = useParams();\n\n  const goToMessages = async (chat) => {\n    if (unreadMessages(chat) > 0) {\n      try {\n        await api.post(`/chats/${chat.id}/read`, { userId: user.id });\n      } catch (err) {}\n    }\n\n    if (id !== chat.uuid) {\n      history.push(`/chats/${chat.uuid}`);\n      handleSelectChat(chat);\n    }\n  };\n\n  const handleDelete = () => {\n    handleDeleteChat(selectedChat);\n  };\n\n  const unreadMessages = (chat) => {\n    const currentUser = chat.users.find((u) => u.userId === user.id);\n    return currentUser.unreads;\n  };\n\n  const getPrimaryText = (chat) => {\n    const mainText = chat.title;\n    const unreads = unreadMessages(chat);\n    return (\n      <>\n        {mainText}\n        {unreads > 0 && (\n          <Chip\n            size=\"small\"\n            style={{ marginLeft: 5 }}\n            label={unreads}\n            color=\"secondary\"\n          />\n        )}\n      </>\n    );\n  };\n\n  const getSecondaryText = (chat) => {\n    return chat.lastMessage !== \"\"\n      ? `${datetimeToClient(chat.updatedAt)}: ${chat.lastMessage}`\n      : \"\";\n  };\n\n  const getItemStyle = (chat) => {\n    return {\n      borderLeft: chat.uuid === id ? \"6px solid #b8b8b8\" : null,\n      backgroundColor: chat.uuid === id ? \"theme.palette.chatlist\" : null,\n    };\n  };\n\n  return (\n    <>\n      <ConfirmationModal\n        title={\"Excluir Conversa\"}\n        open={confirmationModal}\n        onClose={setConfirmModalOpen}\n        onConfirm={handleDelete}\n      >\n        Esta ação não pode ser revertida, confirmar?\n      </ConfirmationModal>\n      <div className={classes.mainContainer}>\n        <div className={classes.chatList}>\n          <List>\n            {Array.isArray(chats) &&\n              chats.length > 0 &&\n              chats.map((chat, key) => (\n                <ListItem\n                  onClick={() => goToMessages(chat)}\n                  key={key}\n                  className={classes.listItem}\n                  style={getItemStyle(chat)}\n                  button\n                >\n                  <ListItemText\n                    primary={getPrimaryText(chat)}\n                    secondary={getSecondaryText(chat)}\n                  />\n                  {chat.ownerId === user.id && (\n                    <ListItemSecondaryAction>\n                      <IconButton\n                        onClick={() => {\n                          goToMessages(chat).then(() => {\n                            handleEditChat(chat);\n                          });\n                        }}\n                        edge=\"end\"\n                        aria-label=\"delete\"\n                        size=\"small\"\n                        style={{ marginRight: 5 }}\n                      >\n                        <EditIcon />\n                      </IconButton>\n                      <IconButton\n                        onClick={() => {\n                          setSelectedChat(chat);\n                          setConfirmModalOpen(true);\n                        }}\n                        edge=\"end\"\n                        aria-label=\"delete\"\n                        size=\"small\"\n                      >\n                        <DeleteIcon />\n                      </IconButton>\n                    </ListItemSecondaryAction>\n                  )}\n                </ListItem>\n              ))}\n          </List>\n        </div>\n      </div>\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}