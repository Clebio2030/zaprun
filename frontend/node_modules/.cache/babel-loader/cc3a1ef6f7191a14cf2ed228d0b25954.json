{"ast":null,"code":"import{useState,useEffect,useContext}from\"react\";import{useHistory}from\"react-router-dom\";import{has,isArray}from\"lodash\";import{toast}from\"react-toastify\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import toastError from\"../../errors/toastError\";import{socketConnection}from\"../../services/socket\";// import { useDate } from \"../../hooks/useDate\";\nimport moment from\"moment\";const useAuth=()=>{const history=useHistory();const[isAuth,setIsAuth]=useState(false);const[loading,setLoading]=useState(true);const[user,setUser]=useState({});const[socket,setSocket]=useState({});api.interceptors.request.use(config=>{const token=localStorage.getItem(\"token\");if(token){config.headers[\"Authorization\"]=\"Bearer \".concat(JSON.parse(token));setIsAuth(true);}return config;},error=>{Promise.reject(error);});api.interceptors.response.use(response=>{return response;},async error=>{var _error$response,_error$response2;const originalRequest=error.config;if((error===null||error===void 0?void 0:(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===403&&!originalRequest._retry){originalRequest._retry=true;const{data}=await api.post(\"/auth/refresh_token\");if(data){localStorage.setItem(\"token\",JSON.stringify(data.token));api.defaults.headers.Authorization=\"Bearer \".concat(data.token);}return api(originalRequest);}if((error===null||error===void 0?void 0:(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status)===401){localStorage.removeItem(\"token\");api.defaults.headers.Authorization=undefined;setIsAuth(false);}return Promise.reject(error);});useEffect(()=>{const token=localStorage.getItem(\"token\");(async()=>{if(token){try{const{data}=await api.post(\"/auth/refresh_token\");api.defaults.headers.Authorization=\"Bearer \".concat(data.token);setIsAuth(true);setUser(data.user);}catch(err){toastError(err);}}setLoading(false);})();},[]);useEffect(()=>{if(Object.keys(user).length&&user.id>0){let io;if(!Object.keys(socket).length){io=socketConnection({user});setSocket(io);}else{io=socket;}io.on(\"company-\".concat(user.companyId,\"-user\"),data=>{if(data.action===\"update\"&&data.user.id===user.id){setUser(data.user);}});return()=>{io.off(\"company-\".concat(user.companyId,\"-user\"));// io.disconnect();\n};}},[user]);const handleLogin=async userData=>{setLoading(true);try{const{data}=await api.post(\"/auth/login\",userData);const{user:{company}}=data;if(has(company,\"companieSettings\")&&isArray(company.companieSettings[0])){const setting=company.companieSettings[0].find(s=>s.key===\"campaignsEnabled\");if(setting&&setting.value===\"true\"){localStorage.setItem(\"cshow\",null);//regra pra exibir campanhas\n}}if(has(company,\"companieSettings\")&&isArray(company.companieSettings[0])){const setting=company.companieSettings[0].find(s=>s.key===\"sendSignMessage\");const signEnable=setting.value===\"enable\";if(setting&&setting.value===\"enabled\"){localStorage.setItem(\"sendSignMessage\",signEnable);//regra pra exibir campanhas\n}}localStorage.setItem(\"profileImage\",data.user.profileImage);//regra pra exibir imagem contato\nmoment.locale('pt-br');let dueDate;if(data.user.company.id===1){dueDate='2999-12-31T00:00:00.000Z';}else{dueDate=data.user.company.dueDate;}const hoje=moment(moment()).format(\"DD/MM/yyyy\");const vencimento=moment(dueDate).format(\"DD/MM/yyyy\");var diff=moment(dueDate).diff(moment(moment()).format());var before=moment(moment().format()).isBefore(dueDate);var dias=moment.duration(diff).asDays();if(before===true){localStorage.setItem(\"token\",JSON.stringify(data.token));// localStorage.setItem(\"public-token\", JSON.stringify(data.user.token));\n// localStorage.setItem(\"companyId\", companyId);\n// localStorage.setItem(\"userId\", id);\nlocalStorage.setItem(\"companyDueDate\",vencimento);api.defaults.headers.Authorization=\"Bearer \".concat(data.token);setUser(data.user);setIsAuth(true);toast.success(i18n.t(\"auth.toasts.success\"));if(Math.round(dias)<5){toast.warn(\"Sua assinatura vence em \".concat(Math.round(dias),\" \").concat(Math.round(dias)===1?'dia':'dias',\" \"));}// // Atraso para garantir que o cache foi limpo\n// setTimeout(() => {\n//   window.location.reload(true); // Recarregar a página\n// }, 1000);\nhistory.push(\"/tickets\");setLoading(false);}else{// localStorage.setItem(\"companyId\", companyId);\napi.defaults.headers.Authorization=\"Bearer \".concat(data.token);setIsAuth(true);toastError(\"Opss! Sua assinatura venceu \".concat(vencimento,\".\\nEntre em contato com o Suporte para mais informa\\xE7\\xF5es! \"));history.push(\"/financeiro-aberto\");setLoading(false);}}catch(err){toastError(err);setLoading(false);}};const handleLogout=async()=>{setLoading(true);try{// socket.disconnect();\nawait api.delete(\"/auth/logout\");setIsAuth(false);setUser({});localStorage.removeItem(\"token\");localStorage.removeItem(\"cshow\");// localStorage.removeItem(\"public-token\");\napi.defaults.headers.Authorization=undefined;setLoading(false);history.push(\"/login\");}catch(err){toastError(err);setLoading(false);}};const getCurrentUserInfo=async()=>{try{const{data}=await api.get(\"/auth/me\");return data;}catch(_){return null;}};return{isAuth,user,loading,handleLogin,handleLogout,getCurrentUserInfo,socket};};export default useAuth;","map":{"version":3,"names":["useState","useEffect","useContext","useHistory","has","isArray","toast","i18n","api","toastError","socketConnection","moment","useAuth","history","isAuth","setIsAuth","loading","setLoading","user","setUser","socket","setSocket","interceptors","request","use","config","token","localStorage","getItem","headers","concat","JSON","parse","error","Promise","reject","response","_error$response","_error$response2","originalRequest","status","_retry","data","post","setItem","stringify","defaults","Authorization","removeItem","undefined","err","Object","keys","length","id","io","on","companyId","action","off","handleLogin","userData","company","companieSettings","setting","find","s","key","value","signEnable","profileImage","locale","dueDate","hoje","format","vencimento","diff","before","isBefore","dias","duration","asDays","success","t","Math","round","warn","push","handleLogout","delete","getCurrentUserInfo","get","_"],"sources":["C:/ProjectsCode/ZapRun/ZapRun/frontend/src/hooks/useAuth.js/index.js"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { has, isArray } from \"lodash\";\n\nimport { toast } from \"react-toastify\";\n\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport toastError from \"../../errors/toastError\";\nimport { socketConnection } from \"../../services/socket\";\n// import { useDate } from \"../../hooks/useDate\";\nimport moment from \"moment\";\n\nconst useAuth = () => {\n  const history = useHistory();\n  const [isAuth, setIsAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [user, setUser] = useState({});\n  const [socket, setSocket] = useState({})\n \n\n  api.interceptors.request.use(\n    (config) => {\n      const token = localStorage.getItem(\"token\");\n      if (token) {\n        config.headers[\"Authorization\"] = `Bearer ${JSON.parse(token)}`;\n        setIsAuth(true);\n      }\n      return config;\n    },\n    (error) => {\n      Promise.reject(error);\n    }\n  );\n\n  api.interceptors.response.use(\n    (response) => {\n      return response;\n    },\n    async (error) => {\n      const originalRequest = error.config;\n      if (error?.response?.status === 403 && !originalRequest._retry) {\n        originalRequest._retry = true;\n\n        const { data } = await api.post(\"/auth/refresh_token\");\n        if (data) {\n          localStorage.setItem(\"token\", JSON.stringify(data.token));\n          api.defaults.headers.Authorization = `Bearer ${data.token}`;\n        }\n        return api(originalRequest);\n      }\n      if (error?.response?.status === 401) {\n        localStorage.removeItem(\"token\");\n        api.defaults.headers.Authorization = undefined;\n        setIsAuth(false);\n      }\n      return Promise.reject(error);\n    }\n  );\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    (async () => {\n      if (token) {\n        try {\n          const { data } = await api.post(\"/auth/refresh_token\");\n          api.defaults.headers.Authorization = `Bearer ${data.token}`;\n          setIsAuth(true);\n          setUser(data.user);\n        } catch (err) {\n          toastError(err);\n        }\n      }\n      setLoading(false);\n    })();\n  }, []);\n\n  useEffect(() => {\n    if (Object.keys(user).length && user.id > 0) {\n      let io;\n      if (!Object.keys(socket).length) {\n        io = socketConnection({ user });\n        setSocket(io)\n      } else {\n        io = socket\n      }\n      io.on(`company-${user.companyId}-user`, (data) => {\n        if (data.action === \"update\" && data.user.id === user.id) {\n          setUser(data.user);\n        }\n      });\n\n      return () => {\n        io.off(`company-${user.companyId}-user`);\n        // io.disconnect();\n      };\n    }\n  }, [user]);\n\n  const handleLogin = async (userData) => {\n    setLoading(true);\n\n    try {\n      const { data } = await api.post(\"/auth/login\", userData);\n      const {\n        user: { company },\n      } = data;\n\n      if (has(company, \"companieSettings\") && isArray(company.companieSettings[0])) {\n        const setting = company.companieSettings[0].find(\n          (s) => s.key === \"campaignsEnabled\"\n        );\n        if (setting && setting.value === \"true\") {\n          localStorage.setItem(\"cshow\", null); //regra pra exibir campanhas\n        }\n      }\n\n      if (has(company, \"companieSettings\") && isArray(company.companieSettings[0])) {\n        const setting = company.companieSettings[0].find(\n          (s) => s.key === \"sendSignMessage\"\n        );\n\n        const signEnable = setting.value === \"enable\";\n\n        if (setting && setting.value === \"enabled\") {\n          localStorage.setItem(\"sendSignMessage\", signEnable); //regra pra exibir campanhas\n        }\n      }\n      localStorage.setItem(\"profileImage\", data.user.profileImage); //regra pra exibir imagem contato\n\n      moment.locale('pt-br');\n      let dueDate;\n      if (data.user.company.id === 1) {\n        dueDate = '2999-12-31T00:00:00.000Z'\n      } else {\n        dueDate = data.user.company.dueDate;\n      }\n      const hoje = moment(moment()).format(\"DD/MM/yyyy\");\n      const vencimento = moment(dueDate).format(\"DD/MM/yyyy\");\n\n      var diff = moment(dueDate).diff(moment(moment()).format());\n\n      var before = moment(moment().format()).isBefore(dueDate);\n      var dias = moment.duration(diff).asDays();\n\n      if (before === true) {\n        localStorage.setItem(\"token\", JSON.stringify(data.token));\n        // localStorage.setItem(\"public-token\", JSON.stringify(data.user.token));\n        // localStorage.setItem(\"companyId\", companyId);\n        // localStorage.setItem(\"userId\", id);\n        localStorage.setItem(\"companyDueDate\", vencimento);\n        api.defaults.headers.Authorization = `Bearer ${data.token}`;\n        setUser(data.user);\n        setIsAuth(true);\n        toast.success(i18n.t(\"auth.toasts.success\"));\n        if (Math.round(dias) < 5) {\n          toast.warn(`Sua assinatura vence em ${Math.round(dias)} ${Math.round(dias) === 1 ? 'dia' : 'dias'} `);\n        }\n\n        // // Atraso para garantir que o cache foi limpo\n        // setTimeout(() => {\n        //   window.location.reload(true); // Recarregar a página\n        // }, 1000);\n\n        history.push(\"/tickets\");\n        setLoading(false);\n      } else {\n        // localStorage.setItem(\"companyId\", companyId);\n        api.defaults.headers.Authorization = `Bearer ${data.token}`;\n        setIsAuth(true);\n        toastError(`Opss! Sua assinatura venceu ${vencimento}.\nEntre em contato com o Suporte para mais informações! `);\n        history.push(\"/financeiro-aberto\");\n        setLoading(false);\n      }\n\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n  };\n\n  const handleLogout = async () => {\n    setLoading(true);\n\n    try {\n      // socket.disconnect();\n      await api.delete(\"/auth/logout\");\n      setIsAuth(false);\n      setUser({});\n      localStorage.removeItem(\"token\");\n      localStorage.removeItem(\"cshow\");\n      // localStorage.removeItem(\"public-token\");\n      api.defaults.headers.Authorization = undefined;\n      setLoading(false);\n      history.push(\"/login\");\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n  };\n\n  const getCurrentUserInfo = async () => {\n    try {\n      const { data } = await api.get(\"/auth/me\");\n      return data;\n    } catch (_) {\n      return null;\n    }\n  };\n\n  return {\n    isAuth,\n    user,\n    loading,\n    handleLogin,\n    handleLogout,\n    getCurrentUserInfo,\n    socket\n  };\n};\n\nexport default useAuth;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}