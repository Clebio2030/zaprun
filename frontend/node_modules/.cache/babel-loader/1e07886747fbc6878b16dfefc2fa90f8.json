{"ast":null,"code":"import React,{useContext,useEffect,useState}from\"react\";import{makeStyles,Modal,Backdrop,Fade,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Paper,IconButton}from\"@material-ui/core\";import DeleteIcon from\"@material-ui/icons/Delete\";import CloseIcon from\"@material-ui/icons/Close\";import api from\"../../services/api\";import{AuthContext}from\"../../context/Auth/AuthContext\";const useStyles=makeStyles(theme=>({modal:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},paper:{backgroundColor:theme.palette.background.paper,boxShadow:theme.shadows[5],padding:theme.spacing(2,4,3),borderRadius:\"8px\",overflow:\"auto\",maxHeight:\"80vh\"},closeButton:{position:\"absolute\",top:theme.spacing(1),right:theme.spacing(1)}}));const handleRemoveContactTag=async(contactId,tagId)=>{await api.delete(\"/tags-contacts/\".concat(tagId,\"/\").concat(contactId));};const ContactTagListModal=_ref=>{let{open,onClose,tag}=_ref;const classes=useStyles();const[tagList,setTagList]=useState(tag.contacts);const{user,socket}=useContext(AuthContext);useEffect(()=>{console.log(\"tagList\",tagList);},[tagList]);useEffect(()=>{// const socket = socketManager.GetSocket(user.companyId, user.id);\nconst onCompanyTags=data=>{if(data.action===\"update\"||data.action===\"create\"){var _data$tag,_data$tag$contacts,_data$tag2,_data$tag2$contacts;if(data.tag.id===tag.id&&((_data$tag=data.tag)===null||_data$tag===void 0?void 0:(_data$tag$contacts=_data$tag.contacts)===null||_data$tag$contacts===void 0?void 0:_data$tag$contacts.length)>0){setTagList(data.tag.contacts);}if(data.tag.id===tag.id&&((_data$tag2=data.tag)===null||_data$tag2===void 0?void 0:(_data$tag2$contacts=_data$tag2.contacts)===null||_data$tag2$contacts===void 0?void 0:_data$tag2$contacts.length)===0){setTagList([]);onClose();}}};socket.on(\"company\".concat(user.companyId,\"-tag\"),onCompanyTags);return()=>{socket.off(\"company\".concat(user.companyId,\"-tag\"),onCompanyTags);};},[]);// Dependência do estado auxiliar updateFlag\nreturn tagList.length>0?/*#__PURE__*/React.createElement(Modal,{className:classes.modal,open:open,onClose:onClose,closeAfterTransition:true,BackdropComponent:Backdrop,BackdropProps:{timeout:500}},/*#__PURE__*/React.createElement(Fade,{in:open},/*#__PURE__*/React.createElement(\"div\",{className:classes.paper},/*#__PURE__*/React.createElement(IconButton,{className:classes.closeButton,onClick:onClose},/*#__PURE__*/React.createElement(CloseIcon,null)),/*#__PURE__*/React.createElement(\"h2\",{id:\"transition-modal-title\"},tag.name,\" - Contatos\"),/*#__PURE__*/React.createElement(TableContainer,{component:Paper},/*#__PURE__*/React.createElement(Table,null,/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,null,\"ID\"),/*#__PURE__*/React.createElement(TableCell,null,\"Nome\"),/*#__PURE__*/React.createElement(TableCell,null,\"Nmero\"),/*#__PURE__*/React.createElement(TableCell,null,\"A\\xE7\\xF5es\"))),/*#__PURE__*/React.createElement(TableBody,null,tagList===null||tagList===void 0?void 0:tagList.map(contact=>/*#__PURE__*/React.createElement(TableRow,{key:contact.id},/*#__PURE__*/React.createElement(TableCell,null,contact.id),/*#__PURE__*/React.createElement(TableCell,null,contact.name),/*#__PURE__*/React.createElement(TableCell,null,contact.number),/*#__PURE__*/React.createElement(TableCell,null,/*#__PURE__*/React.createElement(IconButton,{onClick:()=>handleRemoveContactTag(contact.id,tag.id)},/*#__PURE__*/React.createElement(DeleteIcon,null))))))))))):/*#__PURE__*/React.createElement(React.Fragment,null);};export default ContactTagListModal;","map":{"version":3,"names":["React","useContext","useEffect","useState","makeStyles","Modal","Backdrop","Fade","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","IconButton","DeleteIcon","CloseIcon","api","AuthContext","useStyles","theme","modal","display","alignItems","justifyContent","paper","backgroundColor","palette","background","boxShadow","shadows","padding","spacing","borderRadius","overflow","maxHeight","closeButton","position","top","right","handleRemoveContactTag","contactId","tagId","delete","concat","ContactTagListModal","_ref","open","onClose","tag","classes","tagList","setTagList","contacts","user","socket","console","log","onCompanyTags","data","action","_data$tag","_data$tag$contacts","_data$tag2","_data$tag2$contacts","id","length","on","companyId","off","createElement","className","closeAfterTransition","BackdropComponent","BackdropProps","timeout","in","onClick","name","component","map","contact","key","number","Fragment"],"sources":["C:/ProjectsCode/ZapRun/ZapRun/frontend/src/components/ContactTagListModal/index.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport {\n  makeStyles,\n  Modal,\n  Backdrop,\n  Fade,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Paper,\n  IconButton,\n} from \"@material-ui/core\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport api from \"../../services/api\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\n\nconst useStyles = makeStyles((theme) => ({\n  modal: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  paper: {\n    backgroundColor: theme.palette.background.paper,\n    boxShadow: theme.shadows[5],\n    padding: theme.spacing(2, 4, 3),\n    borderRadius: \"8px\",\n    overflow: \"auto\",\n    maxHeight: \"80vh\",\n  },\n  closeButton: {\n    position: \"absolute\",\n    top: theme.spacing(1),\n    right: theme.spacing(1),\n  },\n}));\n\nconst handleRemoveContactTag = async (contactId, tagId) => {\n  await api.delete(`/tags-contacts/${tagId}/${contactId}`);\n}\n\nconst ContactTagListModal = ({ open, onClose, tag }) => {\n  const classes = useStyles();\n  const [tagList, setTagList] = useState(tag.contacts);\n  const { user, socket } = useContext(AuthContext);\n\n  useEffect(() => {\n    console.log(\"tagList\", tagList)\n  }, [tagList])\n\n  useEffect(() => {\n    // const socket = socketManager.GetSocket(user.companyId, user.id);\n\n    const onCompanyTags = (data) => {\n      if (data.action === \"update\" || data.action === \"create\") {\n        if (data.tag.id === tag.id && data.tag?.contacts?.length > 0) {\n          setTagList(data.tag.contacts);\n        }\n        if (data.tag.id === tag.id && data.tag?.contacts?.length === 0) {\n          setTagList([]);\n          onClose();\n        }\n      }\n    };\n    socket.on(`company${user.companyId}-tag`, onCompanyTags);\n\n    return () => {\n      socket.off(`company${user.companyId}-tag`, onCompanyTags);\n    };\n  }, []); // Dependência do estado auxiliar updateFlag\n\n  return tagList.length > 0 ? (\n    <Modal\n      className={classes.modal}\n      open={open}\n      onClose={onClose}\n      closeAfterTransition\n      BackdropComponent={Backdrop}\n      BackdropProps={{\n        timeout: 500,\n      }}\n    >\n      <Fade in={open}>\n        <div className={classes.paper}>\n          <IconButton className={classes.closeButton} onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n          <h2 id=\"transition-modal-title\">{tag.name} - Contatos</h2>\n          <TableContainer component={Paper}>\n            <Table>\n              <TableHead>\n                <TableRow>\n                  <TableCell>ID</TableCell>\n                  <TableCell>Nome</TableCell>\n                  <TableCell>Nmero</TableCell>\n                  <TableCell>Ações</TableCell>\n                </TableRow>\n              </TableHead>\n              <TableBody>\n                {tagList?.map((contact) => (\n                  <TableRow key={contact.id}>\n                    <TableCell>{contact.id}</TableCell>\n                    <TableCell>{contact.name}</TableCell>\n                    <TableCell>{contact.number}</TableCell>\n                    <TableCell>\n                      <IconButton onClick={() => handleRemoveContactTag(contact.id, tag.id)}>\n                        <DeleteIcon />\n                      </IconButton>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </TableContainer>\n        </div>\n      </Fade>\n    </Modal>\n  ) : (\n    <></>\n  )\n};\n\nexport default ContactTagListModal;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}